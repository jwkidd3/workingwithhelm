<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="DevelopIntelligence">
<title>Working with Helm</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Working with Helm</h1>
<div class="details">
<span id="author" class="author">DevelopIntelligence</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_welcome">Welcome</a></li>
<li><a href="#_virtual_training">Virtual Training</a>
<ul class="sectlevel2">
<li><a href="#_virtual_training_expectations_for_me">Virtual Training Expectations For Me</a></li>
<li><a href="#_virtual_training_expectations_for_you">Virtual Training Expectations For You</a></li>
</ul>
</li>
<li><a href="#_about_developintelligence">About DevelopIntelligence</a>
<ul class="sectlevel2">
<li><a href="#_technologies_we_teach">Technologies we teach</a></li>
<li><a href="#_our_practitioners">Our Practitioners</a></li>
</ul>
</li>
<li><a href="#_course_overview">Course Overview</a></li>
<li><a href="#_audience">Audience</a></li>
<li><a href="#_purpose">Purpose</a></li>
<li><a href="#_prerequisites_for_the_class">Prerequisites for the Class</a></li>
<li><a href="#_objectives">Objectives</a>
<ul class="sectlevel2">
<li><a href="#_objectives_continued">Objectives Continued</a></li>
<li><a href="#_objectives_continued_2">Objectives Continued</a></li>
</ul>
</li>
<li><a href="#_introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#_purpose_2">Purpose</a></li>
</ul>
</li>
<li><a href="#_architecture">Architecture</a>
<ul class="sectlevel2">
<li><a href="#_components_v2">Components (v2)</a></li>
<li><a href="#_components_v3">Components (v3)</a></li>
<li><a href="#_helm_client">Helm Client</a></li>
<li><a href="#_implementation">Implementation</a></li>
</ul>
</li>
<li><a href="#_installing">Installing</a>
<ul class="sectlevel2">
<li><a href="#_installing_kubectl_on_mac">Installing <code>kubectl</code> on Mac</a></li>
<li><a href="#_installing_kubectl_on_linux">Installing <code>kubectl</code> on Linux</a></li>
<li><a href="#_installing_docker">Installing Docker</a></li>
<li><a href="#_install_kubernetes">Install Kubernetes</a></li>
<li><a href="#_installing_docker_desktop_for_kubernetes">Installing Docker Desktop for Kubernetes</a></li>
<li><a href="#_selecting_adequate_memory">Selecting Adequate Memory</a></li>
<li><a href="#_turning_on_docker_desktop_kubernetes">Turning on Docker Desktop Kubernetes</a></li>
<li><a href="#_installing_helm">Installing Helm</a></li>
<li><a href="#_homebrew_install_of_helm_on_macosx">Homebrew Install of Helm on MacOSX</a></li>
<li><a href="#_linux_helm_install">Linux Helm Install</a></li>
<li><a href="#_other_installation_instructions">Other Installation Instructions</a></li>
<li><a href="#_stopping_docker_desktop">Stopping Docker-Desktop</a></li>
</ul>
</li>
<li><a href="#_kubernetes">Kubernetes</a>
<ul class="sectlevel2">
<li><a href="#_kubernetes_node_port_and_cluster_ip">Kubernetes Node Port and Cluster IP</a></li>
<li><a href="#_3_tier_architecture">3-tier Architecture</a></li>
<li><a href="#_review_of_resources">Review of Resources</a></li>
<li><a href="#_pod">Pod</a></li>
<li><a href="#_service">Service</a></li>
<li><a href="#_deployment">Deployment</a></li>
<li><a href="#_configmap">ConfigMap</a></li>
<li><a href="#_serviceaccount">ServiceAccount</a></li>
<li><a href="#_ingress">Ingress</a></li>
<li><a href="#_kubernetes_and_ingress">Kubernetes and Ingress</a></li>
</ul>
</li>
<li><a href="#_basic_operations">Basic Operations</a></li>
<li><a href="#_glossary_of_terms">Glossary of Terms</a>
<ul class="sectlevel2">
<li><a href="#_chart_definition"><em>Chart</em> Definition</a></li>
<li><a href="#_repository_definition"><em>Repository</em> Definition</a></li>
<li><a href="#_release_definition"><em>Release</em> Definition</a></li>
<li><a href="#_glossary_review">Glossary Review</a></li>
</ul>
</li>
<li><a href="#_setting_up_a_repository">Setting up a Repository</a>
<ul class="sectlevel2">
<li><a href="#_setting_up_the_initial_repository">Setting up the Initial Repository</a></li>
<li><a href="#_repository_update">Repository Update</a></li>
<li><a href="#_finding_charts">Finding Charts</a></li>
<li><a href="#_chart_search_results">Chart Search Results</a></li>
<li><a href="#_helm_charts">Helm Charts</a></li>
<li><a href="#_search_for_specific_charts">Search for Specific Charts</a></li>
<li><a href="#_inspect_your_search">Inspect your search</a></li>
<li><a href="#_inspect_your_search_example">Inspect your Search Example</a></li>
<li><a href="#_show_chart_results">Show Chart Results</a></li>
<li><a href="#_view_information_on_a_chart_before_installing">View information on a chart before installing</a></li>
<li><a href="#_install_chart">Install Chart</a></li>
<li><a href="#_dry_run_install_chart">Dry-Run Install Chart</a></li>
<li><a href="#_show_all_releases">Show all releases</a></li>
<li><a href="#_determining_the_status">Determining the Status</a></li>
<li><a href="#_querying_values_to_override">Querying Values to Override</a></li>
<li><a href="#_showing_values">Showing Values</a></li>
<li><a href="#_setting_the_values">Setting the Values</a></li>
<li><a href="#_showing_the_chart">Showing the Chart</a></li>
<li><a href="#_upgrading_the_chart">Upgrading the Chart</a></li>
<li><a href="#_upgrading_the_chart_with_a_file">Upgrading the Chart with a File</a></li>
<li><a href="#_uninstall_a_release">Uninstall a release</a></li>
<li><a href="#_uninstall_with_a_history">Uninstall with a History</a></li>
<li><a href="#_getting_autocomplete_help">Getting Autocomplete Help</a></li>
<li><a href="#_getting_help">Getting Help</a></li>
</ul>
</li>
<li><a href="#_lab_1_install_chart">Lab 1: Install Chart</a></li>
<li><a href="#_yaml_primer">YAML Primer</a>
<ul class="sectlevel2">
<li><a href="#_yaml_list">YAML List</a></li>
<li><a href="#_yaml_map">YAML Map</a></li>
<li><a href="#_integer_scalars">Integer Scalars</a></li>
<li><a href="#_boolean_scalars">Boolean Scalars</a></li>
<li><a href="#_null"><code>null</code></a></li>
<li><a href="#_coercing_yaml_values">Coercing YAML Values</a></li>
<li><a href="#_yaml_strings">YAML Strings</a></li>
<li><a href="#_multiline_strings">Multiline Strings</a></li>
<li><a href="#_multiline_with_trimming">Multiline with Trimming</a></li>
<li><a href="#_indentation_is_preserved">Indentation is Preserved</a></li>
<li><a href="#_maintaining_all_trailing_whitespaces">Maintaining all Trailing Whitespaces</a></li>
<li><a href="#_folded_multiline_strings">Folded Multiline Strings</a></li>
<li><a href="#_folding_and_trimming">Folding and Trimming</a></li>
<li><a href="#_embedding_multiple_documents">Embedding Multiple Documents</a></li>
<li><a href="#_yaml_anchors">YAML Anchors</a></li>
</ul>
</li>
<li><a href="#_create_basic_chart">Create Basic Chart</a>
<ul class="sectlevel2">
<li><a href="#_creating_a_chart">Creating a Chart</a></li>
<li><a href="#_chart_yaml"><code>Chart.yaml</code></a></li>
<li><a href="#_charts_directory"><code>charts</code> Directory</a></li>
<li><a href="#_templates_directory"><code>templates</code> Directory</a></li>
<li><a href="#_additional_fields">Additional Fields</a></li>
<li><a href="#_additional_fields_continued">Additional Fields Continued</a></li>
<li><a href="#_maintainers">Maintainers:</a></li>
<li><a href="#_semver_standard">SemVer Standard</a></li>
<li><a href="#_charts_and_versioning">Charts and Versioning</a></li>
<li><a href="#_appversion"><code>appVersion</code></a></li>
<li><a href="#_deprecating_charts">Deprecating Charts</a></li>
<li><a href="#_license_readme_notes_txt"><em>LICENSE</em>, <em>README, _Notes.txt</em></a></li>
<li><a href="#_helmignore_file"><em>.helmignore</em> File</a></li>
<li><a href="#_debugging_templates">Debugging Templates</a></li>
</ul>
</li>
<li><a href="#_lab_2_create_a_basic_chart">Lab 2: Create a Basic Chart</a></li>
<li><a href="#_chart_dependencies">Chart Dependencies</a>
<ul class="sectlevel2">
<li><a href="#_establishing_chart_dependencies">Establishing Chart Dependencies</a></li>
<li><a href="#_downloading_dependencies">Downloading Dependencies</a></li>
<li><a href="#_how_dependencies_are_stored">How Dependencies are Stored</a></li>
<li><a href="#_using_alias">Using <code>alias</code></a></li>
<li><a href="#_alias_results"><code>alias</code> Results</a></li>
<li><a href="#_using_conditions">Using Conditions</a></li>
<li><a href="#_using_tags">Using Tags</a></li>
<li><a href="#_parent_chart">Parent Chart</a></li>
<li><a href="#_subchart_2_requirements">Subchart 2 Requirements</a></li>
<li><a href="#_parent_chart_values">Parent Chart Values</a></li>
<li><a href="#_tags_conditions">Tags &amp; Conditions</a></li>
</ul>
</li>
<li><a href="#_lab_3_dependencies">Lab 3: Dependencies</a></li>
<li><a href="#_templates">Templates</a>
<ul class="sectlevel2">
<li><a href="#_creating_chart">Creating <code>chart</code></a></li>
<li><a href="#_about_templates">About Templates</a></li>
<li><a href="#_values_yaml"><code>values.yaml</code></a></li>
<li><a href="#_chart_yaml_2"><code>Chart.yaml</code></a></li>
<li><a href="#_inside_templates">Inside <code>templates</code></a></li>
<li><a href="#_example_template">Example <code>template</code></a></li>
<li><a href="#_viewing_the_template">Viewing the template</a></li>
<li><a href="#_retrieving_the_release">Retrieving the Release</a></li>
<li><a href="#_setting_a_release_name">Setting a Release Name</a></li>
<li><a href="#_running_the_template">Running the Template</a></li>
<li><a href="#_debugging_the_content">Debugging the Content</a></li>
<li><a href="#_objects">Objects</a></li>
<li><a href="#_release_object"><code>Release</code> Object</a></li>
<li><a href="#_values_object"><code>Values</code> Object</a></li>
<li><a href="#_chart_object"><code>Chart</code> Object</a></li>
<li><a href="#_files_object"><code>Files</code> Object</a></li>
<li><a href="#_capabilities"><code>Capabilities</code></a></li>
<li><a href="#_template"><code>Template</code></a></li>
<li><a href="#_convention_spelling">Convention Spelling</a></li>
<li><a href="#_values_files">Values Files</a></li>
<li><a href="#_example_of_getting_an_attribute">Example of getting an attribute</a></li>
<li><a href="#_rendering_the_attribute">Rendering the attribute</a></li>
<li><a href="#_overriding_the_attribute">Overriding the Attribute</a></li>
<li><a href="#_multi_level_values_yaml">Multi-level Values.yaml</a></li>
<li><a href="#_deleting_a_default_key">Deleting a default key</a></li>
</ul>
</li>
<li><a href="#_lab_4_templatizing">Lab 4: Templatizing</a></li>
<li><a href="#_functions">Functions</a>
<ul class="sectlevel2">
<li><a href="#_quote"><code>quote</code></a></li>
<li><a href="#_rendering_quote">Rendering <code>quote</code></a></li>
<li><a href="#_over_60_functions_available">Over 60 Functions Available</a></li>
<li><a href="#_pipelines">Pipelines</a></li>
<li><a href="#_chaining_multiple_pipelines">Chaining Multiple Pipelines</a></li>
<li><a href="#_rendering_quote_and_upper">Rendering <code>quote</code> and <code>upper</code></a></li>
<li><a href="#_ordering_does_matter">Ordering does Matter</a></li>
<li><a href="#_answer_ordering_does_matter">Answer: Ordering does Matter</a></li>
<li><a href="#_default_function"><code>default</code> function</a></li>
<li><a href="#_removing_coffee">Removing <code>coffee</code></a></li>
<li><a href="#_operators">Operators</a></li>
<li><a href="#_flow_control">Flow Control</a></li>
<li><a href="#_ifelse"><code>if</code>/<code>else</code></a></li>
<li><a href="#_falsy_values">"Falsy" values</a></li>
<li><a href="#_ifelse_example"><code>if</code>/<code>else</code> Example</a></li>
<li><a href="#_controlling_whitespace">Controlling Whitespace</a></li>
<li><a href="#_rendering_the_extra_space">Rendering the Extra Space</a></li>
<li><a href="#_attempt_to_fix_space_error">Attempt to Fix Space Error</a></li>
<li><a href="#_what_that_renders">What that renders</a></li>
<li><a href="#_using_special_curly_braced_syntax">Using special curly-braced syntax</a></li>
<li><a href="#_reminder_indent_function">Reminder: <code>indent</code> function</a></li>
<li><a href="#_modifying_with_with">Modifying with <code>with</code></a></li>
<li><a href="#_using_with">Using <code>with</code></a></li>
<li><a href="#_exiting_the_with_appropriately">Exiting the <code>with</code> Appropriately</a></li>
<li><a href="#_correcting_the_with_error">Correcting the <code>with</code> error</a></li>
<li><a href="#_looping_with_range">Looping with <code>Range</code></a></li>
<li><a href="#_using_range">Using <code>Range</code></a></li>
<li><a href="#_result_of_using_range">Result of using <code>Range</code></a></li>
<li><a href="#_variables">Variables</a></li>
<li><a href="#_using_variables">Using <code>Variables</code></a></li>
<li><a href="#_after_running_the_example">After Running the Example</a></li>
<li><a href="#_using_variables_with_range">Using Variables with <code>range</code></a></li>
<li><a href="#_using_range_for_key_value_pairs">Using <code>range</code> for Key Value Pairs</a></li>
<li><a href="#_result_of_using_range_for_key_value_pairs">Result of using <code>range</code> for Key Value Pairs</a></li>
<li><a href="#_global_variables">Global Variables</a></li>
<li><a href="#_named_templates">Named Templates</a></li>
<li><a href="#_partials_and_files">Partials and <code>_</code> Files</a></li>
<li><a href="#_declaring_a_template">Declaring a Template</a></li>
<li><a href="#_example_of_a_template">Example of a Template</a></li>
<li><a href="#_embedding_a_template">Embedding a Template</a></li>
<li><a href="#_template_names_are_global">Template names are global</a></li>
<li><a href="#_setting_scope_of_a_template">Setting scope of a template</a></li>
<li><a href="#_what_it_renders">What it Renders</a></li>
<li><a href="#_passing_in_the_scope">Passing in the Scope</a></li>
<li><a href="#_resulting_in_the_following">Resulting in the following</a></li>
<li><a href="#_include_function"><code>include</code> function</a></li>
<li><a href="#_calling_template">Calling <code>template</code></a></li>
<li><a href="#_the_incorrect_output">The Incorrect Output</a></li>
<li><a href="#_include_is_a_function"><code>include</code> is a Function</a></li>
<li><a href="#_what_it_renders_2">What it renders</a></li>
<li><a href="#_accessing_files">Accessing Files</a></li>
<li><a href="#_creating_standard_files">Creating Standard Files</a></li>
<li><a href="#_using_range_to_include_the_files">Using <code>range</code> to include the Files</a></li>
<li><a href="#_results_of_files_and_range">Results of <code>Files</code> and <code>range</code></a></li>
<li><a href="#_path_helpers">Path Helpers</a></li>
<li><a href="#_glob_patterns">Glob Patterns</a></li>
<li><a href="#_given_the_files">Given the files</a></li>
<li><a href="#_using_glob">Using <code>Glob</code>:</a></li>
<li><a href="#_configmap_and_secrets_utility">Configmap and Secrets Utility</a></li>
<li><a href="#_encoding">Encoding</a></li>
<li><a href="#_lines">Lines</a></li>
<li><a href="#_notes_txt">NOTES.txt</a></li>
</ul>
</li>
<li><a href="#_lab_5_functions">Lab 5: Functions</a></li>
<li><a href="#_subcharts">Subcharts</a>
<ul class="sectlevel2">
<li><a href="#_subcharts_definition">Subcharts Definition</a></li>
<li><a href="#_subchart_details">Subchart Details</a></li>
<li><a href="#_creating_a_subchart">Creating a subchart</a></li>
<li><a href="#_adding_values_and_template_to_subchart">Adding Values And Template to Subchart</a></li>
<li><a href="#_using_values_from_subcharts_own_values_yaml">Using <code>Values</code> from Subchart&#8217;s own <code>values.yaml</code></a></li>
<li><a href="#_what_it_renders_3">What it renders</a></li>
<li><a href="#_overriding_the_defaults">Overriding the defaults</a></li>
<li><a href="#_rendering_the_results">Rendering the Results</a></li>
<li><a href="#_global_chart_values">Global Chart Values</a></li>
<li><a href="#_creating_a_global_section_in_values">Creating a Global Section in Values</a></li>
<li><a href="#_configuring_parent_charts_config_map">Configuring Parent Chart&#8217;s Config Map</a></li>
<li><a href="#_configuring_subcharts_config_map">Configuring Subcharts' Config Map</a></li>
<li><a href="#_the_parent_charts_result">The Parent Chart&#8217;s Result</a></li>
<li><a href="#_the_child_charts_result">The Child Chart&#8217;s Result</a></li>
<li><a href="#_sharing_templates_with_subcharts">Sharing Templates with Subcharts</a></li>
</ul>
</li>
<li><a href="#_lab_6_subcharts">Lab 6: Subcharts</a></li>
<li><a href="#_plugins">Plugins</a>
<ul class="sectlevel2">
<li><a href="#_plugin_overview">Plugin Overview</a></li>
<li><a href="#_plugin_features">Plugin Features</a></li>
<li><a href="#_installing_a_plugin">Installing a Plugin</a></li>
<li><a href="#_installing_via_tarball">Installing via Tarball</a></li>
<li><a href="#_example_plugin_s3">Example Plugin: S3</a></li>
<li><a href="#_creating_the_aws_bucket">Creating the AWS Bucket</a></li>
<li><a href="#_installing_the_s3_plugin">Installing the S3 Plugin</a></li>
<li><a href="#_initializing_the_s3_plugin">Initializing the S3 Plugin</a></li>
<li><a href="#_display_all_the_repos">Display all the repos</a></li>
<li><a href="#_creating_a_simple_helm_chart">Creating a Simple Helm Chart</a></li>
<li><a href="#_install_the_chart">Install the Chart</a></li>
<li><a href="#_remove_it_again">Remove it again</a></li>
<li><a href="#_upload_the_test_chart">Upload the test chart</a></li>
<li><a href="#_once_complete_send_it_to_s3">Once complete, send it to S3</a></li>
</ul>
</li>
<li><a href="#_testing_helm">Testing Helm</a>
<ul class="sectlevel2">
<li><a href="#_unit_testing_helm">Unit Testing Helm</a></li>
<li><a href="#_install_as_plugin">Install as Plugin</a></li>
<li><a href="#_building_a_test">Building a Test</a></li>
<li><a href="#_example_test">Example Test</a></li>
<li><a href="#_running_the_test">Running the Test</a></li>
<li><a href="#_snapshot_testing">Snapshot Testing</a></li>
<li><a href="#_snapshot_example_test">Snapshot Example Test</a></li>
<li><a href="#_test_suite_detail">Test Suite Detail</a></li>
<li><a href="#_test_job">Test Job</a></li>
<li><a href="#_test_details">Test Details</a></li>
<li><a href="#_various_assertions">Various Assertions</a></li>
<li><a href="#_integration_testing">Integration Testing</a></li>
<li><a href="#_example_tests">Example Tests</a></li>
<li><a href="#_maria_db_example_helm_test">Maria DB Example Helm Test</a></li>
<li><a href="#_run_an_integration_test_on_the_command_line">Run an Integration Test on the Command Line</a></li>
</ul>
</li>
<li><a href="#_lab_7_testing">Lab 7: Testing</a></li>
<li><a href="#_commands">Commands</a>
<ul class="sectlevel2">
<li><a href="#_helm_completion"><code>helm completion</code></a></li>
<li><a href="#_helm_inspect"><code>helm inspect</code></a></li>
<li><a href="#_helm_list"><code>helm list</code></a></li>
<li><a href="#_helm_package"><code>helm package</code></a></li>
<li><a href="#_helm_plugin"><code>helm plugin</code></a></li>
<li><a href="#_helm_repo"><code>helm repo</code></a></li>
<li><a href="#_helm_upgrade"><code>helm upgrade</code></a></li>
<li><a href="#_helm_rollback"><code>helm rollback</code></a></li>
<li><a href="#_helm_version"><code>helm version</code></a></li>
</ul>
</li>
<li><a href="#_lab_8_deploy">Lab 8: Deploy</a></li>
<li><a href="#_what_is_new_in_helm_v3">What is new in Helm V3?</a>
<ul class="sectlevel2">
<li><a href="#_client_only_architecture">Client-Only Architecture</a></li>
<li><a href="#_xdg_base_directory_specification">XDG base directory specification</a></li>
<li><a href="#_no_need_to_helm_init">No need to <code>helm init</code></a></li>
<li><a href="#_more_specifics">More specifics</a></li>
</ul>
</li>
<li><a href="#_where_to_get_more_information">Where to get more information</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_welcome">Welcome</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/checkin.png" alt="checkin">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_virtual_training">Virtual Training</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/whatwewant.png" alt="whatwewant">
</div>
</div>
<div class="sect2">
<h3 id="_virtual_training_expectations_for_me">Virtual Training Expectations For Me</h3>
<div class="paragraph">
<p>I pledge to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make this as interesting and interactive as possible</p>
</li>
<li>
<p>Ask questions in order to stimulate discussion</p>
</li>
<li>
<p>Use whatever resources I have at hand to explain the material</p>
</li>
<li>
<p>Try my best to manage verbal responses so that everyone who wants to speak can do so</p>
</li>
<li>
<p>Use an on-screen timer for breaks so you know when to be back</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_virtual_training_expectations_for_you">Virtual Training Expectations For You</h3>
<div class="ulist">
<ul>
<li>
<p>Arrive and Return on Time</p>
</li>
<li>
<p>Mute unless speaking</p>
</li>
<li>
<p>Use chat or ask questions verbally</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_about_developintelligence">About DevelopIntelligence</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/about-di.png" alt="about di">
</div>
</div>
<div class="sect2">
<h3 id="_technologies_we_teach">Technologies we teach</h3>
<div class="imageblock">
<div class="content">
<img src="./images/di-tech.png" alt="di tech">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_our_practitioners">Our Practitioners</h3>
<div class="imageblock">
<div class="content">
<img src="./images/di-practitioners.png" alt="di practitioners">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_course_overview">Course Overview</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The Helm Fundamentals course is designed to be an introduction to understanding and working with the Helm Kubernetes package manager.</p>
</li>
<li>
<p>It will start with a journey to understand why Helm exists and its purpose.</p>
</li>
<li>
<p>The course will then navigate a path towards how to work with it, including</p>
<div class="ulist">
<ul>
<li>
<p>Building charts</p>
</li>
<li>
<p>Publishing charts</p>
</li>
<li>
<p>Using them to release and manage Kubernetes workloads</p>
</li>
<li>
<p>Various capabilities Helm offers via its CLI</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_audience">Audience</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Developers, Service Owners, Ops</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_purpose">Purpose</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To gain a comprehensive understanding of Helm and how to use it to package and manage Kubernetes workloads</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites_for_the_class">Prerequisites for the Class</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Knowledge and working experience with Kubernetes. This includes understanding common resources and usage of things like Deployments, Config Maps, Secrets, Pods, Container Spec, etc.</p>
</li>
<li>
<p>Some level of comfort with the command line (kubectl, piping output, navigating folders, etc)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_objectives">Objectives</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Understand the purpose of Helm, why it exists</p>
</li>
<li>
<p>Create Helm charts of your own ready for distribution</p>
</li>
<li>
<p>Test helm in local, and how to validate your changes</p>
</li>
<li>
<p>Understand all features and practices around Helm chart source code</p>
</li>
<li>
<p>Feel comfortable with best practices around using Helm as well as gotchas of Helm</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_objectives_continued">Objectives Continued</h3>
<div class="ulist">
<ul>
<li>
<p>Know how Helm charts are commonly distributed and stored, and work with Helm chart repos</p>
</li>
<li>
<p>Understand the architecture of Helm, where it is today, and where it’s headed</p>
</li>
<li>
<p>Install the Helm CLI, initialize the client and server</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_objectives_continued_2">Objectives Continued</h3>
<div class="ulist">
<ul>
<li>
<p>Use the various features of the CLI including packaging charts, installing and using plugins, installing and upgrading charts.</p>
</li>
<li>
<p>Have awareness of development and testing strategies around Helm charts, and be able to use these strategies</p>
</li>
<li>
<p>How to use Helm securely</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose_2">Purpose</h3>
<div class="ulist">
<ul>
<li>
<p>Manages Kubernetes Applications</p>
</li>
<li>
<p>Templatizes Kubernetes Resources</p>
</li>
<li>
<p>Repeatable Application Installation</p>
</li>
<li>
<p>Upgrade Applications</p>
</li>
<li>
<p>Reusability</p>
</li>
<li>
<p>Share Charts on Repositories</p>
</li>
<li>
<p>Rollback to Previous Applications</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_architecture">Architecture</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Discuss the components of Helm</p>
</li>
<li>
<p>Discuss how Helm is implemented</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_components_v2">Components (v2)</h3>
<div class="paragraph">
<p>Helm has two components (v2):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Client</p>
</li>
<li>
<p>Tiller</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/helm2-arch.png" alt="helm2 arch" width="50%" height="50%">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_components_v3">Components (v3)</h3>
<div class="ulist">
<ul>
<li>
<p>Tiller has been removed</p>
</li>
<li>
<p>Replaced with client/library architecture</p>
</li>
<li>
<p>Interacts directly with the Kubernetes API Server</p>
</li>
<li>
<p>Security is now on a per-user basis.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/helm3-arch.png" alt="helm3 arch" width="50%" height="50%">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_helm_client">Helm Client</h3>
<div class="ulist">
<ul>
<li>
<p>Command Line for End Users</p>
</li>
<li>
<p>Local Chart Development</p>
</li>
<li>
<p>Managing Repositories</p>
</li>
<li>
<p>Sending charts to be installed</p>
</li>
<li>
<p>Asking for information about releases</p>
</li>
<li>
<p>Requesting upgrading or uninstalling of existing releases</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_implementation">Implementation</h3>
<div class="ulist">
<ul>
<li>
<p>Helm is written in the Go Language</p>
</li>
<li>
<p>gRPC is used to interact with the server</p>
</li>
<li>
<p>Uses the Kubernetes client library to communicate with Kubernetes API Server</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installing">Installing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Installing Kubectl</p>
</li>
<li>
<p>Installing Hypervisor and Minikube</p>
</li>
<li>
<p>Installing Docker Desktop</p>
</li>
<li>
<p>Installing Kind</p>
</li>
<li>
<p>Installing Helm</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_installing_kubectl_on_mac">Installing <code>kubectl</code> on Mac</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% brew install kubectl</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installing_kubectl_on_linux">Installing <code>kubectl</code> on Linux</h3>
<div class="paragraph">
<p>Run the following curl download</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">curl -LO https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make <code>kubectl</code> binary executable</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% chmod +x ./kubectl</code></pre>
</div>
</div>
<div class="paragraph">
<p>Move the binary to the <code>PATH</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% sudo mv ./kubectl /usr/local/bin/kubectl</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installing_docker">Installing Docker</h3>
<div class="ulist">
<ul>
<li>
<p>Download and install the latest docker client: <a href="https://docs.docker.com/get-docker/" class="bare">https://docs.docker.com/get-docker/</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_install_kubernetes">Install Kubernetes</h3>
<div class="paragraph">
<p>We are going to be deploying applications on Kubernetes, therefore we need a cluster
Typically, we will manage remote clusters, but for class, and experimentation we will use Docker-Desktop
Though we are using docker-desktop, there are other solutions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Remote Kubernetes</p>
<div class="ulist">
<ul>
<li>
<p>AWS</p>
</li>
<li>
<p>GCP</p>
</li>
<li>
<p>More&#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
<li>
<p>Local Kubernetes</p>
<div class="ulist">
<ul>
<li>
<p>Minikube</p>
</li>
<li>
<p>Kind</p>
</li>
<li>
<p>Docker Desktop</p>
</li>
<li>
<p>K3S</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_installing_docker_desktop_for_kubernetes">Installing Docker Desktop for Kubernetes</h3>
<div class="paragraph">
<p>Visit the Docker Menu and select <strong>Preferences</strong></p>
</div>
<div class="imageblock left">
<div class="content">
<img src="./images/docker-desktop-1.png" alt="docker desktop 1">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_selecting_adequate_memory">Selecting Adequate Memory</h3>
<div class="paragraph">
<p>Select <em>Resources</em> and ensure that you have memory of at least 8.0GB</p>
</div>
<div class="imageblock left">
<div class="content">
<img src="./images/docker-desktop-3.png" alt="docker desktop 3">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_turning_on_docker_desktop_kubernetes">Turning on Docker Desktop Kubernetes</h3>
<div class="paragraph">
<p>Select <em>Kubernetes</em> and select <em>Enable Kubernetes</em></p>
</div>
<div class="imageblock left">
<div class="content">
<img src="./images/docker-desktop-2.png" alt="docker desktop 2">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installing_helm">Installing Helm</h3>
<div class="ulist">
<ul>
<li>
<p>Binary Source</p>
</li>
<li>
<p>Homebrew (MacOSX)</p>
</li>
<li>
<p>Chocolatey (Windows)</p>
</li>
<li>
<p>Snap (Linux)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_homebrew_install_of_helm_on_macosx">Homebrew Install of Helm on MacOSX</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% brew install helm</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_linux_helm_install">Linux Helm Install</h3>
<div class="ulist">
<ul>
<li>
<p>Download from <a href="https://github.com/helm/helm/releases" class="bare">https://github.com/helm/helm/releases</a></p>
</li>
<li>
<p>Unpack it (<code>tar -zxvf helm-v3.3.4-linux-amd64.tgz</code>)</p>
</li>
<li>
<p>Find the helm binary in the unpacked directory, and move it to its desired destination (<code>mv linux-amd64/helm /usr/local/bin/helm</code>)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_other_installation_instructions">Other Installation Instructions</h3>
<div class="paragraph">
<p><a href="https://v3.helm.sh/docs/install/" class="bare">https://v3.helm.sh/docs/install/</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_stopping_docker_desktop">Stopping Docker-Desktop</h3>
<div class="paragraph">
<p>At the end of the class, be sure to stop docker-desktop
Select <em>Kubernetes</em> and select <em>Enable Kubernetes</em> to disable</p>
</div>
<div class="imageblock left">
<div class="content">
<img src="./images/docker-desktop-2.png" alt="docker desktop 2">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kubernetes">Kubernetes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_kubernetes_node_port_and_cluster_ip">Kubernetes Node Port and Cluster IP</h3>
<div class="imageblock">
<div class="content">
<img src="https://i0.wp.com/www.docker.com/blog/wp-content/uploads/2019/09/Kubernetes-NodePort-Service-2.png?w=1069&ssl=1" alt="Kubernetes NodePort Service 2">
</div>
</div>
<div class="openblock notes">
<div class="content">
<div class="paragraph">
<p>Overview of how we will be dealing with Kubernetes
. Our traffic will be request from a Node Port or Ingress (we will be using Ingress). (Analogy: Host of the restaurant)
. This will then contact a Kubernetes Service. (Analogy: The table)
. Load Balanced Pods, each pod can service a request. (Analogy: People at a table)</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_3_tier_architecture">3-tier Architecture</h3>
<div class="imageblock">
<div class="content">
<img src="./images/3-tier.png" alt="3 tier">
</div>
</div>
<div class="openblock notes">
<div class="content">
<div class="paragraph">
<p>Salesforce uses K8s as a three tier architecture where various clusters represent
* frontend
* backend
* database</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_review_of_resources">Review of Resources</h3>

</div>
<div class="sect2">
<h3 id="_pod">Pod</h3>
<div class="ulist">
<ul>
<li>
<p>Group of one or more containers (such as Docker containers)</p>
</li>
<li>
<p>Shared storage/network</p>
</li>
<li>
<p>Specification for how to run the containers</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_service">Service</h3>
<div class="ulist">
<ul>
<li>
<p>Service is an abstraction which defines a logical set of Pods and a policy by which to access them</p>
</li>
<li>
<p>Sometimes this pattern is called a micro-service).</p>
</li>
<li>
<p>The set of Pods targeted by a Service is usually determined by a selector</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_deployment">Deployment</h3>
<div class="ulist">
<ul>
<li>
<p>Provides declarative updates for Pods and ReplicaSets.</p>
</li>
<li>
<p>Describe a desired state in a Deployment</p>
</li>
<li>
<p>Deployment Controller changes the actual state to the desired state at a controlled rate.</p>
</li>
<li>
<p>You can define Deployments to create new ReplicaSets,</p>
</li>
<li>
<p>Or remove existing Deployments and adopt all their resources with new Deployment</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_configmap">ConfigMap</h3>
<div class="ulist">
<ul>
<li>
<p>Bind to your Pods' containers and system components at runtime</p>
<div class="ulist">
<ul>
<li>
<p>Configuration files</p>
</li>
<li>
<p>Command-line arguments</p>
</li>
<li>
<p>Environment variables</p>
</li>
<li>
<p>Port numbers</p>
</li>
<li>
<p>Other configuration artifacts</p>
</li>
</ul>
</div>
</li>
<li>
<p>Enable you to separate your configurations from your Pods and components, making workloads portable.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_serviceaccount">ServiceAccount</h3>
<div class="ulist">
<ul>
<li>
<p>Service accounts allow pods to communicate to the Kubernetes API.</p>
</li>
<li>
<p>They are bound to specific namespaces, and created automatically by the API server or manually through API calls.</p>
</li>
<li>
<p>Service accounts are tied to a set of credentials</p>
</li>
</ul>
</div>
<div class="openblock notes">
<div class="content">
<div class="paragraph">
<p>Be familiar with <a href="https://medium.com/better-programming/k8s-tips-using-a-serviceaccount-801c433d0023" class="bare">https://medium.com/better-programming/k8s-tips-using-a-serviceaccount-801c433d0023</a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ingress">Ingress</h3>
<div class="ulist">
<ul>
<li>
<p>Object defines rules for routing HTTP(S) traffic to applications running in a cluster.</p>
</li>
<li>
<p>An Ingress object is associated with one or more Service objects</p>
</li>
<li>
<p>Each Service is associated with a set of Pods</p>
</li>
</ul>
</div>
<div class="openblock notes">
<div class="content">
<div class="paragraph">
<p>This will provide us with the ability to map an HTTP route with a Service within the same cluster
* <a href="http://salesforce.com/registration" class="bare">http://salesforce.com/registration</a> &#8594; Register Service
* <a href="http://salesforce.com/about" class="bare">http://salesforce.com/about</a> &#8594; About Service</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_kubernetes_and_ingress">Kubernetes and Ingress</h3>
<div class="imageblock">
<div class="content">
<img src="https://d2908q01vomqb2.cloudfront.net/ca3512f4dfa95a03169c5a670a4c91a19b3077b4/2018/11/20/image1-1.png" alt="image1 1">
</div>
</div>
<div class="openblock notes">
<div class="content">
<div class="paragraph">
<p>This is a fuller diagram of how we will deploy in this class
* An ingress accepts traffic and routes to a service
* A service in turn will route to the pods
* The pods in turn are distributed in other nodes</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basic_operations">Basic Operations</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_glossary_of_terms">Glossary of Terms</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_chart_definition"><em>Chart</em> Definition</h3>
<div class="ulist">
<ul>
<li>
<p>A Helm package.</p>
</li>
<li>
<p>Contains all of the resource definitions necessary to run an application, tool, or service inside of a Kubernetes cluster.</p>
</li>
<li>
<p>Think of it like the Kubernetes equivalent of a Homebrew formula, an Apt dpkg, or a Yum RPM file.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_repository_definition"><em>Repository</em> Definition</h3>
<div class="ulist">
<ul>
<li>
<p>A Repository is the place where charts can be collected and shared.</p>
</li>
<li>
<p>It’s like Perl’s CPAN archive, Fedora Package Database, or Maven Central but for Kubernetes packages.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_release_definition"><em>Release</em> Definition</h3>
<div class="ulist">
<ul>
<li>
<p>A Release is an <em>instance</em> of a chart running in a Kubernetes cluster.</p>
</li>
<li>
<p>One chart can often be installed many times into the same cluster.</p>
</li>
<li>
<p>Each time it is installed, a new release is created.</p>
</li>
<li>
<p>For Example:</p>
<div class="ulist">
<ul>
<li>
<p>If you want two databases running in your cluster, you can install that chart twice.</p>
</li>
<li>
<p>Each one will have its own release, which will in turn have its own release name.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_glossary_review">Glossary Review</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Helm installs charts into Kubernetes, creating a new release for each installation. And to find new charts, you can search Helm chart repositories.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_up_a_repository">Setting up a Repository</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_setting_up_the_initial_repository">Setting up the Initial Repository</h3>
<div class="ulist">
<ul>
<li>
<p>The following is the official repository</p>
</li>
<li>
<p>Your use of Helm will lead you to other repositories (e.g. bitnami)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm repo add stable https://charts.helm.sh/stable</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_repository_update">Repository Update</h3>
<div class="paragraph">
<p>Running the following will refresh your local catalog of available helm charts</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm repo update</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_finding_charts">Finding Charts</h3>
<div class="ulist">
<ul>
<li>
<p>You can search for charts using:</p>
<div class="ulist">
<ul>
<li>
<p><code>helm search hub &lt;name&gt;</code> - Search for charts in the Helm Hub or an instance of Monocular</p>
</li>
<li>
<p><code>helm search repo &lt;name&gt;</code> - Search repositories for a keyword in all your repositories</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm search hub mysql</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Monocular is a web-based application that enables the search and discovery of charts from multiple Helm Chart repositories.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_chart_search_results">Chart Search Results</h3>
<div class="paragraph">
<p>Returns for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">URL                                               	CHART VERSION	APP VERSION 	DESCRIPTION
https://hub.helm.sh/charts/prometheus-com/prome...	0.7.1        	v0.11.0     	A Helm chart for prometheus mysql exporter with...
https://hub.helm.sh/charts/incubator/mysqlha      	2.0.0        	5.7.13      	MySQL cluster with a single master and zero or ...
https://hub.helm.sh/charts/presslabs/mysql-cluster	0.2.0        	1.0         	A Helm chart for easy deployment of a MySQL clu...
https://hub.helm.sh/charts/presslabs/mysql-oper...	0.4.0        	v0.4.0      	A Helm chart for mysql operator</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_helm_charts">Helm Charts</h3>
<div class="paragraph">
<p>Another way to find Charts is Helm Hub: <a href="https://artifacthub.io/" class="bare">https://artifacthub.io/</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/hub-helm.png" alt="hub helm">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_search_for_specific_charts">Search for Specific Charts</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm search hadoop</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$  helm search hadoop                                                                                                                             danno@DannoAir
NAME         	CHART VERSION	APP VERSION	DESCRIPTION
stable/hadoop	1.1.2        	2.9.0      	The Apache Hadoop software library is a framework that al...
stable/luigi 	2.7.5        	2.7.2      	Luigi is a Python module that helps you build complex pip...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you will only see the results that match your filter</p>
</div>
</div>
<div class="sect2">
<h3 id="_inspect_your_search">Inspect your search</h3>
<div class="ulist">
<ul>
<li>
<p>You can view information about your chart including</p>
<div class="ulist">
<ul>
<li>
<p>Maintainers</p>
</li>
<li>
<p>Instructions</p>
</li>
<li>
<p>Values</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm show chart &lt;chart&gt; &lt;flags&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_inspect_your_search_example">Inspect your Search Example</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm show chart stable/hadoop</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_show_chart_results">Show Chart Results</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">apiVersion: v1
appVersion: 2.9.0
description: The Apache Hadoop software library is a framework that allows for the
  distributed processing of large data sets across clusters of computers using simple
  programming models.
home: https://hadoop.apache.org/
icon: http://hadoop.apache.org/images/hadoop-logo.jpg
maintainers:
- email: disla@google.com
  name: danisla
name: hadoop
sources:
- https://github.com/apache/hadoop
version: 1.1.2</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_view_information_on_a_chart_before_installing">View information on a chart before installing</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm get chart stable/mysql</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_install_chart">Install Chart</h3>
<div class="paragraph">
<p>To install chart, install a chart using either of the following commands</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm install &lt;release-name&gt; &lt;repo&gt;/&lt;name&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm install --generate-name &lt;repo&gt;/&lt;name&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Each release gets its own name</p>
</li>
<li>
<p>Therefore each can be managed separately</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_dry_run_install_chart">Dry-Run Install Chart</h3>
<div class="paragraph">
<p>To install chart with a dry run you can run either of the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm install --dry-run --debug &lt;release-name&gt; &lt;repo&gt;/&lt;name&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm install --dry-run --debug --generate-name &lt;repo&gt;/&lt;name&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_show_all_releases">Show all releases</h3>
<div class="paragraph">
<p>The following will list all releases that have been installed with information retained</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm list --all</code></pre>
</div>
</div>
<div class="paragraph">
<p>To show only deployed releases</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm list</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use <code>helm ls</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_determining_the_status">Determining the Status</h3>
<div class="ulist">
<ul>
<li>
<p>Deployments need time to download containers</p>
</li>
<li>
<p>Check the status with the following</p>
</li>
<li>
<p>This will also show a NOTES.txt, basic set of chart instructions</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm status &lt;release-name&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_querying_values_to_override">Querying Values to Override</h3>
<div class="paragraph">
<p>Helm charts are extremely flexible to change configuration, the following command shows values</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm show values &lt;chart&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm show values stable/mysql</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_showing_values">Showing Values</h3>
<div class="paragraph">
<p>Values of <code>stable/mysql</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">image: "mysql"
imageTag: "5.7.30"

strategy:
  type: Recreate

busybox:
  image: "busybox"
  tag: "1.32"

testFramework:
  enabled: true
  image: "bats/bats"
  tag: "1.2.1"
  imagePullPolicy: IfNotPresent
  securityContext: {}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_setting_the_values">Setting the Values</h3>
<div class="ulist">
<ul>
<li>
<p>We can see the values that can be changed using <code>helm show values</code></p>
</li>
<li>
<p>All values can be changed!</p>
</li>
<li>
<p>For Example, given the following values formatted as yaml</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">image: "mysql"
imageTag: "5.7.30"

testFramework:
  enabled: true
  image: "bats/bats"
  tag: "1.2.1"
  imagePullPolicy: IfNotPresent
  securityContext: {}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You can change the <code>imageTag</code> using <code>--set imageTag=5.7.31</code></p>
</li>
<li>
<p>You can change nested elements like the <code>tag</code> in <code>testFramework</code> using <code>--set testFramework.tag=1.2.2</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_showing_the_chart">Showing the Chart</h3>
<div class="paragraph">
<p>To describe the chart:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm show chart stable/mysql</code></pre>
</div>
</div>
<div class="paragraph">
<p>The results of showing the chart</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
appVersion: 5.7.30
description: Fast, reliable, scalable, and easy to use open-source relational database
  system.
home: https://www.mysql.com/
icon: https://www.mysql.com/common/logos/logo-mysql-170x115.png
keywords:
- mysql
- database
- sql
maintainers:
- email: o.with@sportradar.com
  name: olemarkus
- email: viglesias@google.com
  name: viglesiasce
name: mysql
sources:
- https://github.com/kubernetes/charts
- https://github.com/docker-library/mysql
version: 1.6.7</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_upgrading_the_chart">Upgrading the Chart</h3>
<div class="paragraph">
<p>If you need to make a change with the values, or make another adjustment</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm upgrade &lt;release-name&gt; &lt;chart&gt; &lt;flag&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm upgrade --set imageTag=5.7.30 --set testFramework.tag=1.2.2 super-dog stable/mysql</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_upgrading_the_chart_with_a_file">Upgrading the Chart with a File</h3>
<div class="ulist">
<ul>
<li>
<p>If you have your own <em>values.yaml</em> file, you can include it using the <code>-f</code> flag</p>
</li>
<li>
<p>Priority will be given to the right hand flag</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm upgrade -f myvalues.yaml -f override.yaml super-dog stable/mysql</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_uninstall_a_release">Uninstall a release</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm uninstall &lt;release-name&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm uninstall super-dog</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Use <code>--dry-run</code> switch to see what will be uninstalled with actually uninstalling them
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_uninstall_with_a_history">Uninstall with a History</h3>
<div class="ulist">
<ul>
<li>
<p>Using <code>--keep-history</code> will retain deployment history</p>
</li>
<li>
<p>You can view previous deployments using:</p>
<div class="ulist">
<ul>
<li>
<p><code>helm list --uninstalled</code></p>
</li>
<li>
<p><code>helm list --all</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm uninstall --keep-history</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_getting_autocomplete_help">Getting Autocomplete Help</h3>
<div class="paragraph">
<p>For Bash:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm completion bash</code></pre>
</div>
</div>
<div class="paragraph">
<p>For ZSH:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm completion zsh</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_getting_help">Getting Help</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm get -h</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">$ helm ls -h</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_1_install_chart">Lab 1: Install Chart</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Open your lab book, <em>lab_book.html</em>, and do "Lab 1: Install a public chart"</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_yaml_primer">YAML Primer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Agenda:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Understand Quickly YAML Specifications</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Source: <a href="https://v2.helm.sh/docs/chart_template_guide/#yaml-techniques" class="bare">https://v2.helm.sh/docs/chart_template_guide/#yaml-techniques</a></p>
</div>
<div class="sect2">
<h3 id="_yaml_list">YAML List</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">sequence:
  - one
  - two
  - three</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_yaml_map">YAML Map</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">map:
  one: 1
  two: 2
  three: 3</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_integer_scalars">Integer Scalars</h3>
<div class="paragraph">
<p>If an integer or float is an unquoted bare word, it is typically treated as a numeric type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">count: 1
size: 2.34</code></pre>
</div>
</div>
<div class="paragraph">
<p>If they are quoted, they are treated as strings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">count: "1" # &lt;-- string, not int
size: '2.34' # &lt;-- string, not float</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_boolean_scalars">Boolean Scalars</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">isGood: true   # bool
answer: "true" # string</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_null"><code>null</code></h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">isAvailable: null</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_coercing_yaml_values">Coercing YAML Values</h3>
<div class="ulist">
<ul>
<li>
<p>You can coerce YAML values using <code>!!</code></p>
</li>
<li>
<p>Below:</p>
<div class="ulist">
<ul>
<li>
<p><code>!!str</code> tells the parser that age is a string, even if it looks like an <code>int</code>.</p>
</li>
<li>
<p><code>port</code> is treated as an <code>int</code>, even though it is quoted.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">coffee: "yes, please"
age: !!str 21
port: !!int "80"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_yaml_strings">YAML Strings</h3>
<div class="paragraph">
<p>Three inline ways to declare a string</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">way1: bare words
way2: "double-quoted strings"
way3: 'single-quoted strings'</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Bare words are unquoted, and are not escaped. For this reason, you have to be careful what characters you use.</p>
</li>
<li>
<p>Double-quoted strings can have specific characters escaped with <code>\</code>.</p>
<div class="ulist">
<ul>
<li>
<p>For example <code>"\"Hello\", she said"</code>.</p>
</li>
<li>
<p>You can escape line breaks with <code>\n</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Single-quoted strings are “literal” strings, and do not use the <code>\</code> to escape characters.</p>
<div class="ulist">
<ul>
<li>
<p>The only escape sequence is <code>''</code>, which is decoded as a single <code>'</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_multiline_strings">Multiline Strings</h3>
<div class="ulist">
<ul>
<li>
<p>Multiline strings can be declared using <code>|</code></p>
</li>
<li>
<p>The following is equivalent to: <code>Latte\nCappuccino\nEspresso\n</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">coffee: |
  Latte
  Cappuccino
  Espresso</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The first line has be correctly indented
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_multiline_with_trimming">Multiline with Trimming</h3>
<div class="ulist">
<ul>
<li>
<p>The previous slide will render a multiline string with an additional newline</p>
</li>
<li>
<p>To trim the extra newline, use a dash <code>-</code></p>
</li>
<li>
<p>The following is equivalent to: <code>Latte\nCappuccino\nEspresso</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">coffee: |-
  Latte
  Cappuccino
  Espresso</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_indentation_is_preserved">Indentation is Preserved</h3>
<div class="ulist">
<ul>
<li>
<p>Indentation inside of a text block is preserved, this includes line breaks</p>
</li>
<li>
<p>In the following, <code>coffee</code> is <code>Latte\n 12 oz\n 16 oz\nCappuccino\nEspresso</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">coffee: |-
  Latte
    12 oz
    16 oz
  Cappuccino
  Espresso</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_maintaining_all_trailing_whitespaces">Maintaining all Trailing Whitespaces</h3>
<div class="ulist">
<ul>
<li>
<p>Using <code>|+</code> maintains all trailing whitespace</p>
</li>
<li>
<p>The following evaluates to: <code>Latte\nCappuccino\nEspresso\n\n\n</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">coffee: |+
  Latte
  Cappuccino
  Espresso


another: value</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_folded_multiline_strings">Folded Multiline Strings</h3>
<div class="ulist">
<ul>
<li>
<p>Sometimes you want to represent a string in your YAML with multiple lines, but want it to be treated as one long line.</p>
</li>
<li>
<p>This is called “folding”.</p>
</li>
<li>
<p>To declare a folded block, use <code>&gt;</code> instead of <code>|</code></p>
</li>
<li>
<p>The following will render <code>coffee</code> as <code>Latte Cappuccino Espresso\n</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">coffee: &gt;
  Latte
  Cappuccino
  Espresso</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_folding_and_trimming">Folding and Trimming</h3>
<div class="ulist">
<ul>
<li>
<p>Given the previous slide, it still maintains the last <code>\n</code></p>
</li>
<li>
<p>We can then use <code>&gt;-</code> to fold and trim all the newlines</p>
</li>
<li>
<p>The following produces for <code>coffee</code>: <code>Latte\n 12 oz\n 16 oz\nCappuccino Espresso</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">coffee: &gt;-
  Latte
    12 oz
    16 oz
  Cappuccino
  Espresso</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_embedding_multiple_documents">Embedding Multiple Documents</h3>
<div class="ulist">
<ul>
<li>
<p>You can embed multiple yaml files in a single file</p>
</li>
<li>
<p>This is done by prefixing: <code><em>_</em></code>, and ending with <code>&#8230;&#8203;</code></p>
</li>
<li>
<p>In many cases they can be omitted since it would be up to the parser</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">---
document:1
...
---
document: 2
...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_yaml_anchors">YAML Anchors</h3>
<div class="ulist">
<ul>
<li>
<p>YAML spec provides a way to store a reference to a value and later refer to that value by reference.</p>
</li>
<li>
<p>YAML refers to this as “anchoring”</p>
</li>
<li>
<p>Use <code>&amp;</code> as the reference</p>
</li>
<li>
<p>Use <code>*</code> as the pointer</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">coffee: "yes, please"
favorite: &amp;favoriteCoffee "Cappucino"
coffees:
  - Latte
  - *favoriteCoffee
  - Espresso</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
References is expanded and then discarded. The anchors in Helm and K8s will be lost
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_basic_chart">Create Basic Chart</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Agenda:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creating a chart</p>
</li>
<li>
<p>Understanding templates</p>
</li>
<li>
<p>Performing Dry Runs</p>
</li>
<li>
<p>Understanding Values</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_creating_a_chart">Creating a Chart</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm create mychart</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">.
└── mychart
    ├── Chart.yaml
    ├── charts
    ├── templates
    │   ├── NOTES.txt
    │   ├── _helpers.tpl
    │   ├── deployment.yaml
    │   ├── ingress.yaml
    │   ├── service.yaml
    │   ├── serviceaccount.yaml
    │   └── tests
    │       └── test-connection.yaml
    └── values.yaml</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_chart_yaml"><code>Chart.yaml</code></h3>
<div class="paragraph">
<p>A default YAML file containing information about the chart</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
appVersion: "1.0"
description: A Helm chart for Kubernetes
name: mychart
version: 0.1.0</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">apiVersion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chart API version</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">appVersion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version that app contains</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single sentence description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the project</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SemVer 2 version</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_charts_directory"><code>charts</code> Directory</h3>
<div class="paragraph">
<p>The <code>charts</code> directory is a directory containing any charts upon which this chart depends</p>
</div>
</div>
<div class="sect2">
<h3 id="_templates_directory"><code>templates</code> Directory</h3>
<div class="paragraph">
<p>A directory of templates that, when combined with values, will generate valid Kubernetes manifest files</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>_helpers.tpl</code> - helper templates</p>
</li>
<li>
<p>Kubernetes files</p>
</li>
<li>
<p>tests - unit</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_additional_fields">Additional Fields</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubeVersion</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SemverRange of compatible K8s versions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>keywords</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of keywords</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>home</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Project&#8217;s Home Page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of URLs of source code</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maintainers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of maintainers (see maintainer object)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_additional_fields_continued">Additional Fields Continued</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>engine</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the template engine; default: Go Template Engine</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>icon</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SVG or PNG representing the chart</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deprecated</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether this chart is deprecated</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tillerVersion</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version of Tiller (Semver)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_maintainers">Maintainers:</h3>
<div class="paragraph">
<p>The maintainers, previous slide looks like the following</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maintainer&#8217;s name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>email</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maintainer&#8217;s email</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>url</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maintainer&#8217;s url</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_semver_standard">SemVer Standard</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://semver.org/" class="bare">https://semver.org/</a></p>
</li>
<li>
<p>Given a version number MAJOR.MINOR.PATCH, increment the:</p>
<div class="ulist">
<ul>
<li>
<p><strong>MAJOR</strong> version when you make incompatible API changes,</p>
</li>
<li>
<p><strong>MINOR</strong> version when you add functionality in a backwards compatible manner, and</p>
</li>
<li>
<p><strong>PATCH</strong> version when you make backwards compatible bug fixes.</p>
</li>
<li>
<p>Additional labels for pre-release and build metadata are available as extensions to the <strong>MAJOR.MINOR.PATCH</strong> format.</p>
</li>
</ul>
</div>
</li>
<li>
<p>There are additional rules, see website for details</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_charts_and_versioning">Charts and Versioning</h3>
<div class="ulist">
<ul>
<li>
<p>Versions must follow SemVer2 Versioning</p>
</li>
<li>
<p>Example the tar ball that represents nginx, given the name <code>nginx</code> and version <code>1.2.3</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>nginx-1.2.3.tgz</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Version field is in the <em>chart.yml</em> is used by various tools. All version numbers <em>must match</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_appversion"><code>appVersion</code></h3>
<div class="ulist">
<ul>
<li>
<p>App version is for users' use, purely informational</p>
</li>
<li>
<p>Doesn&#8217;t follow SemVer rules</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_deprecating_charts">Deprecating Charts</h3>
<div class="ulist">
<ul>
<li>
<p>The optional <code>deprecated</code> field in <em>Chart.yaml</em> can be used to mark a chart as deprecated</p>
</li>
<li>
<p>If the latest version of a chart in the repository is marked as deprecated, then the chart as a whole is considered to be deprecated.</p>
</li>
<li>
<p>The chart name can later be reused by publishing a newer version that is not marked as <code>deprecated</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_license_readme_notes_txt"><em>LICENSE</em>, <em>README, _Notes.txt</em></h3>
<div class="ulist">
<ul>
<li>
<p><em>LICENSE</em> is the licensing used in Helm</p>
</li>
<li>
<p><em>README</em> is Markdown information on how to use the chart</p>
</li>
<li>
<p><em>template/NOTES.txt</em> used to display the status of the release when using <code>helm package</code> or <code>helm status</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_helmignore_file"><em>.helmignore</em> File</h3>
<div class="ulist">
<ul>
<li>
<p>Used to specify files you don’t want to include in your helm chart.</p>
</li>
<li>
<p>If the file exists, the <code>helm package</code> (used to package for distribution) command will ignore all the files that match the pattern specified in the <em>.helmignore</em> file while packaging your application.</p>
</li>
<li>
<p>This can help in avoiding unnecessary or sensitive files or directories from being added in your helm chart.</p>
</li>
<li>
<p>The <em>.helmignore</em> file supports Unix shell glob matching, relative path matching, and negation (prefixed with !).</p>
</li>
<li>
<p>Only one pattern per line is considered.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="property"># comment
.git
*/temp*
*/*/temp*
temp?</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_debugging_templates">Debugging Templates</h3>
<div class="ulist">
<ul>
<li>
<p>While things may look well on the client</p>
</li>
<li>
<p>When it is sent to the Kubernetes API, it may reject</p>
</li>
<li>
<p>To help debug, you can use the following:</p>
<div class="ulist">
<ul>
<li>
<p><code>helm lint</code> is your go-to tool for verifying that your chart follows best practices</p>
</li>
<li>
<p><code>helm install --dry-run --debug</code> render your templates and eyeball the results</p>
</li>
<li>
<p><code>helm get manifest</code> see what templates have already been installed on the server</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_2_create_a_basic_chart">Lab 2: Create a Basic Chart</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Open your lab book, <em>lab_book.html</em>, and do "Lab 2: Create a basic chart"</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_chart_dependencies">Chart Dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Agenda:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding Dependencies to your chart</p>
</li>
<li>
<p>Use Tags and Conditions to select what is included</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_establishing_chart_dependencies">Establishing Chart Dependencies</h3>
<div class="paragraph">
<p><em>Chart.yaml</em> is used to link one chart with another chart</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">dependencies:
- name: apache
  version: 1.2.3
  repository: http://example.com/charts
- name: mysql
  version: 3.2.1
  repository: http://another.example.com/charts</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>name</code> field is the name of the chart you want.</p>
</li>
<li>
<p>The <code>version</code> field is the version of the chart you want.</p>
</li>
<li>
<p>The <code>repository</code> field is the full URL to the chart repository.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You must also use helm repo add to add that repo locally.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_downloading_dependencies">Downloading Dependencies</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm dependency up my-chart
Hang tight while we grab the latest from your chart repositories...
...Successfully got an update from the "local" chart repository
...Successfully got an update from the "stable" chart repository
...Successfully got an update from the "example" chart repository
...Successfully got an update from the "another" chart repository
Update Complete.
Saving 2 charts
Downloading apache from repo http://example.com/charts
Downloading mysql from repo http://another.example.com/charts</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_dependencies_are_stored">How Dependencies are Stored</h3>
<div class="paragraph">
<p>The tarballs will be installed in the <em>charts/</em> directory</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">charts/
  apache-1.2.3.tgz
  mysql-3.2.1.tgz</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_alias">Using <code>alias</code></h3>
<div class="ulist">
<ul>
<li>
<p>Use <code>alias</code> in cases where they need to access a chart with other name</p>
</li>
<li>
<p>The following is using the <em>same chart</em> three different times</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">dependencies:
- name: subchart
  repository: http://localhost:10191
  version: 0.1.0
  alias: new-subchart-1
- name: subchart
  repository: http://localhost:10191
  version: 0.1.0
  alias: new-subchart-2
- name: subchart
  repository: http://localhost:10191
  version: 0.1.0</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_alias_results"><code>alias</code> Results</h3>
<div class="paragraph">
<p>The previous slide creates:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">subchart
new-subchart-1
new-subchart-2</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_conditions">Using Conditions</h3>
<div class="ulist">
<ul>
<li>
<p>The condition field holds one or more YAML paths (delimited by commas).</p>
</li>
<li>
<p>If this path exists in the <em>parent’s values</em> and resolves to a boolean value,</p>
</li>
<li>
<p>the chart will be enabled or disabled based on that boolean value.</p>
</li>
<li>
<p>Only the first valid path found in the list is evaluated and if no paths exist then the condition has no effect.</p>
</li>
<li>
<p>For multiple level dependencies the condition is prepended by the path to the parent chart.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_using_tags">Using Tags</h3>
<div class="ulist">
<ul>
<li>
<p>The tags field is a YAML list of labels to associate with this chart.</p>
</li>
<li>
<p>In the top parent’s values, all charts with tags can be enabled or disabled by specifying the tag and a boolean value.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_parent_chart">Parent Chart</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># parentchart/requirements.yaml
dependencies:
  - name: subchart1
    repository: http://localhost:10191
    version: 0.1.0
    condition: subchart1.enabled
    tags:
      - front-end
      - subchart1

  - name: subchart2
    repository: http://localhost:10191
    version: 0.1.0
    condition: subchart2.enabled
    tags:
      - back-end
      - subchart2</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_subchart_2_requirements">Subchart 2 Requirements</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># subchart2/requirements.yaml
dependencies:
  - name: subsubchart
    repository: http://localhost:10191
    version: 0.1.0
    condition: subsubchart.enabled</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_parent_chart_values">Parent Chart Values</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">subchart1:
  enabled: true
subchart2:
  subsubchart:
    enabled: false
tags:
  front-end: false
  back-end: true</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>All charts with <code>front-end</code> would be disabled, but</p>
</li>
<li>
<p>Conditions override tags, <code>subchart1</code> is enabled, therefore <code>subchart1</code> is enabled.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_tags_conditions">Tags &amp; Conditions</h3>
<div class="ulist">
<ul>
<li>
<p>Conditions (when set in values) always override tags.</p>
</li>
<li>
<p>The first condition path that exists wins and subsequent ones for that chart are ignored.</p>
</li>
<li>
<p>Tags and conditions values must be set in the top parent’s <em>values.yaml</em>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_3_dependencies">Lab 3: Dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Open your lab book, <em>lab_book.html</em>, and do "Lab 3: Dependencies"</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_templates">Templates</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_creating_chart">Creating <code>chart</code></h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm create chart</code></pre>
</div>
</div>
<div class="paragraph">
<p>Creates the following directory</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>mychart/
  Chart.yaml
  values.yaml
  charts/
  templates/
  ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_about_templates">About Templates</h3>
<div class="ulist">
<ul>
<li>
<p><code>templates</code> directory contain the template files</p>
</li>
<li>
<p>All the files in the <code>templates</code> directory will go through the template rendering engine</p>
</li>
<li>
<p>It collects the results and sends it through Kubernetes</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_values_yaml"><code>values.yaml</code></h3>
<div class="ulist">
<ul>
<li>
<p>Contains default values for charts</p>
</li>
<li>
<p>Then can be overriden by</p>
<div class="ulist">
<ul>
<li>
<p><code>helm install</code></p>
</li>
<li>
<p><code>helm upgrade</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_chart_yaml_2"><code>Chart.yaml</code></h3>
<div class="ulist">
<ul>
<li>
<p>Contains a description of the chart</p>
</li>
<li>
<p>It can be accessed from the template</p>
</li>
<li>
<p>Charts can create other charts called <em>subcharts</em></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_inside_templates">Inside <code>templates</code></h3>
<div class="ulist">
<ul>
<li>
<p><code>NOTES.txt</code> - "Help text" - Displayed when they run <code>helm install</code></p>
</li>
<li>
<p><code>deployment.yaml</code> - A basic manifest for creating a Kubernetes deployment</p>
</li>
<li>
<p><code>service.yaml</code> - A basic manifest for creating a service endpoint for your deployment</p>
</li>
<li>
<p><code>_helpers.tpl</code>: A place to put template helpers that you can re-use throughout the chart</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_example_template">Example <code>template</code></h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: mychart-configmap
data:
  myvalue: "Hello World"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Convention, use <code>.yaml</code> extension for yaml files, and <code>.tpl</code> for helpers
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_viewing_the_template">Viewing the template</h3>
<div class="paragraph">
<p>We can install it using <code>helm install mychart</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm install --generate-name ./mychart

NAME: full-coral
LAST DEPLOYED: Tue Nov  1 17:36:01 2016
NAMESPACE: default
STATUS: DEPLOYED

RESOURCES:
==&gt; v1/ConfigMap
NAME                DATA      AGE
mychart-configmap   1         1m</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>full-coral</code> is the release name, it is either manually created or chosen randomly
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_retrieving_the_release">Retrieving the Release</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm get manifest full-coral

---
# Source: mychart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: mychart-configmap
data:
  myvalue: "Hello World"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_setting_a_release_name">Setting a Release Name</h3>
<div class="ulist">
<ul>
<li>
<p>Best Practice is the replace the <code>Name:</code> field</p>
</li>
<li>
<p>We can create a Template call of the name</p>
</li>
<li>
<p>The dots are called <em>namespace objects</em></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running_the_template">Running the Template</h3>
<div class="ulist">
<ul>
<li>
<p>Installing the chart</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm install ./mychart</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Getting the Manifest</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm get manifest ./mychart</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_debugging_the_content">Debugging the Content</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm install ./mychart --debug --dry-run</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>--dry-run</code> will make it easier to test your code
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_objects">Objects</h3>
<div class="ulist">
<ul>
<li>
<p>Passed into the template engine</p>
</li>
<li>
<p>Can be created within the template engine</p>
</li>
<li>
<p>Can simple with one value</p>
</li>
<li>
<p>Contain other objects and functions</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_release_object"><code>Release</code> Object</h3>
<div class="ulist">
<ul>
<li>
<p><code>Release</code>: This object describes the release itself. It has several objects inside of it:</p>
</li>
<li>
<p><code>Release.Name</code>: The release name</p>
</li>
<li>
<p><code>Release.Time</code>: The time of the release</p>
</li>
<li>
<p><code>Release.Namespace</code>: The namespace to be released into (if the manifest doesn’t override)</p>
</li>
<li>
<p><code>Release.Service</code>: The name of the releasing service (always <code>Helm</code>).</p>
</li>
<li>
<p><code>Release.Revision</code>: The revision number of this release. It begins at 1 and is incremented for each helm upgrade.</p>
</li>
<li>
<p><code>Release.IsUpgrade</code>: This is set to true if the current operation is an upgrade or rollback.</p>
</li>
<li>
<p><code>Release.IsInstall</code>: This is set to true if the current operation is an install.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_values_object"><code>Values</code> Object</h3>
<div class="ulist">
<ul>
<li>
<p>Values passed into the template from</p>
<div class="ulist">
<ul>
<li>
<p>The <em>values.yaml</em> file</p>
</li>
<li>
<p>From user-supplied files.</p>
</li>
<li>
<p>By default, <code>Values</code> is empty.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_chart_object"><code>Chart</code> Object</h3>
<div class="ulist">
<ul>
<li>
<p>The contents of the <em>Chart.yaml</em> file</p>
</li>
<li>
<p>Any data in Chart.yaml will be accessible here</p>
</li>
<li>
<p>e.g. <code>{{.Chart.Name}}-{{.Chart.Version}}</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_files_object"><code>Files</code> Object</h3>
<div class="ulist">
<ul>
<li>
<p>This provides access to all non-special files in a chart.</p>
</li>
<li>
<p>While you cannot use it to access templates, you can use it to access other files in the chart.</p>
</li>
<li>
<p><code>Files.Get</code> is a function for getting a file by name (.Files.Get config.ini)</p>
</li>
<li>
<p><code>Files.GetBytes</code> is a function for getting the contents of a file as an array of bytes instead of as a string.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_capabilities"><code>Capabilities</code></h3>
<div class="ulist">
<ul>
<li>
<p>This provides information about what capabilities the Kubernetes cluster supports</p>
</li>
<li>
<p><code>Capabilities.APIVersions</code>- Set of versions.</p>
</li>
<li>
<p><code>Capabilities.APIVersions.Has $version</code> -</p>
<div class="ulist">
<ul>
<li>
<p>Indicates whether a version (e.g., batch/v1) or resource (e.g., apps/v1/Deployment) is available on the cluster.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>Capabilities.KubeVersion</code></p>
<div class="ulist">
<ul>
<li>
<p>Provides a way to look up the Kubernetes version.</p>
</li>
<li>
<p>It has the following values: <code>Major</code>, <code>Minor</code>, <code>GitVersion</code>, <code>GitCommit</code>, <code>GitTreeState</code>, <code>BuildDate</code>, <code>GoVersion</code>, <code>Compiler</code>, and <code>Platform</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_template"><code>Template</code></h3>
<div class="paragraph">
<p>Contains information about the current template that is being executed</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Name</code> - A namespaced filepath to the current template (e.g. <code>mychart/templates/mytemplate.yaml</code>)</p>
</li>
<li>
<p><code>BasePath</code> - The namespaced path to the templates directory of the current chart (e.g. <code>mychart/templates</code>)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_convention_spelling">Convention Spelling</h3>
<div class="ulist">
<ul>
<li>
<p>Choose lower case for <code>Values</code> objects</p>
</li>
<li>
<p>Reserve upper case for built-in objects</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_values_files">Values Files</h3>
<div class="paragraph">
<p>Values comes from the following in descending order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <em>values.yaml</em> file in the chart</p>
</li>
<li>
<p>If this is a subchart, the <em>values.yaml</em> file of a parent chart</p>
</li>
<li>
<p>A values file is passed into helm install or helm upgrade with the <code>-f</code> flag (<code>helm install -f myvals.yaml ./mychart</code>)</p>
</li>
<li>
<p>Individual parameters passed with <code>--set</code> (such as <code>helm install --set foo=bar ./mychart</code>)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_example_of_getting_an_attribute">Example of getting an attribute</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"
  drink: {{ .Values.favoriteDrink }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rendering_the_attribute">Rendering the attribute</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># Source: mychart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: geared-marsupi-configmap
data:
  myvalue: "Hello World"
  drink: coffee</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_overriding_the_attribute">Overriding the Attribute</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm install --dry-run --debug --set favoriteDrink=slurm ./mychart</code></pre>
</div>
</div>
<div class="paragraph">
<p>Renders:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: solid-vulture-configmap
data:
  myvalue: "Hello World"
  drink: slurm</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multi_level_values_yaml">Multi-level Values.yaml</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">favorite:
  drink: coffee
  food: pizza</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"
  drink: {{ .Values.favorite.drink }}
  food: {{ .Values.favorite.food }}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Keep trees shallow in <code>values.yaml</code> as much as possible
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_deleting_a_default_key">Deleting a default key</h3>
<div class="paragraph">
<p>To delete a key, override the value with <code>null</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">livenessProbe:
  httpGet:
    path: /user/login
    port: http</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm install ./chart --set livenessProbe.httpGet=null</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_4_templatizing">Lab 4: Templatizing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Open your lab book, <em>lab_book.html</em>, and do "Lab 4: Templatizing"</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functions">Functions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Allows us to transform the values</p>
</li>
<li>
<p>Works much like functional programming</p>
</li>
<li>
<p>Functions work with the syntax: <code>functionName arg1 arg2&#8230;&#8203;</code></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_quote"><code>quote</code></h3>
<div class="paragraph">
<p>Places a quote (<code>"</code>) around the food when evaluated</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"
  drink: {{ .Values.favorite.drink | quote }}
  food: {{ .Values.favorite.food | quote }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rendering_quote">Rendering <code>quote</code></h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># Source: mychart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: trendsetting-p-configmap
data:
  myvalue: "Hello World"
  drink: "coffee"
  food: "PIZZA"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_over_60_functions_available">Over 60 Functions Available</h3>
<div class="paragraph">
<p>Functions are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://godoc.org/text/template">Go Template Library</a></p>
</li>
<li>
<p><a href="http://masterminds.github.io/sprig/">Sprig template library</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_pipelines">Pipelines</h3>
<div class="ulist">
<ul>
<li>
<p>Analogous to Pipeline in UNIX shell scripting</p>
</li>
<li>
<p>Each function is applied to the tail to perform actions</p>
</li>
<li>
<p>The following is equivalent to the previous slide</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"
  drink: {{ .Values.favorite.drink | quote }}
  food: {{ .Values.favorite.food | quote }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_chaining_multiple_pipelines">Chaining Multiple Pipelines</h3>
<div class="paragraph">
<p>The following will convert <code>favorite.food</code> to upper case and then add a quote</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"
  drink: {{ .Values.favorite.drink | quote }}
  food: {{ .Values.favorite.food | upper | quote }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rendering_quote_and_upper">Rendering <code>quote</code> and <code>upper</code></h3>
<div class="paragraph">
<p>Here is the result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># Source: mychart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: trendsetting-p-configmap
data:
  myvalue: "Hello World"
  drink: "coffee"
  food: "PIZZA"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ordering_does_matter">Ordering does Matter</h3>
<div class="paragraph">
<p>Getting the order down is important, determine the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"
  drink: {{ .Values.favorite.drink | repeat 5 | quote }}
  food: {{ .Values.favorite.food | upper | quote }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_answer_ordering_does_matter">Answer: Ordering does Matter</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># Source: mychart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: melting-porcup-configmap
data:
  myvalue: "Hello World"
  drink: "coffeecoffeecoffeecoffeecoffee"
  food: "PIZZA"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_default_function"><code>default</code> function</h3>
<div class="ulist">
<ul>
<li>
<p>The default function is: <code>default DEFAULT_VALUE GIVEN_VALUE</code></p>
</li>
<li>
<p>Running it will provide us with the following:</p>
</li>
<li>
<p>Although works with static values, works well with functions</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">drink: {{ .Values.favorite.drink | default "tea" | quote }}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># Source: mychart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: virtuous-mink-configmap
data:
  myvalue: "Hello World"
  drink: "coffee"
  food: "PIZZA"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_removing_coffee">Removing <code>coffee</code></h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># Source: mychart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: fair-worm-configmap
data:
  myvalue: "Hello World"
  drink: "tea"
  food: "PIZZA"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_operators">Operators</h3>
<div class="ulist">
<ul>
<li>
<p>Operators that return a boolean value. To use <code>eq</code>, <code>ne</code>, <code>lt</code>, <code>gt</code>, <code>and</code>, <code>or</code>, <code>not</code></p>
</li>
<li>
<p>To chain operators, separate by surrounding them with parenthesis</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title"><code>and</code> and <code>eq</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">(and .Values.fooString (eq .Values.fooString "foo"))</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>or</code> and <code>not</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">(or .Values.anUnsetVariable (not .Values.aSetVariable))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_flow_control">Flow Control</h3>
<div class="paragraph">
<p>We will cover basic flow control:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>if</code>/<code>else</code> for creating conditional blocks</p>
</li>
<li>
<p><code>with</code> to specify a scope</p>
</li>
<li>
<p><code>range</code>, which provides a “for each”-style loop</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And wade our way into templates</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>define</code> declares a new named template inside of your template</p>
</li>
<li>
<p><code>template</code> imports a named template</p>
</li>
<li>
<p><code>block</code> declares a special kind of fillable template area</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_ifelse"><code>if</code>/<code>else</code></h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{ if PIPELINE }}
  # Do something
{{ else if OTHER PIPELINE }}
  # Do something else
{{ else }}
  # Default case
{{ end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_falsy_values">"Falsy" values</h3>
<div class="paragraph">
<p>A pipeline is <code>false</code> if a value is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <code>boolean</code> false</p>
</li>
<li>
<p>a numeric zero</p>
</li>
<li>
<p>an empty string</p>
</li>
<li>
<p>a <code>nil</code> (empty or null)</p>
</li>
<li>
<p>an empty collection (<code>map</code>, <code>slice</code>, <code>tuple</code>, <code>dict</code>, <code>array</code>)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_ifelse_example"><code>if</code>/<code>else</code> Example</h3>
<div class="ulist">
<ul>
<li>
<p>The following checks for an absence of a value</p>
</li>
<li>
<p>The determines the equality using <code>eq</code></p>
</li>
<li>
<p>If so, the create <code>mug:true</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"
  drink: {{ .Values.favorite.drink | default "tea" | quote }}
  food: {{ .Values.favorite.food | upper | quote }}
  {{ if and .Values.favorite.drink (eq .Values.favorite.drink "coffee") }}mug: true{{ end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_controlling_whitespace">Controlling Whitespace</h3>
<div class="ulist">
<ul>
<li>
<p>The following creates an <code>error converting YAML to JSON</code> error due to indentation</p>
</li>
<li>
<p><code>mug:true</code> is indented too far right, and is an isolated key</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"
  drink: {{ .Values.favorite.drink | default "tea" | quote }}
  food: {{ .Values.favorite.food | upper | quote }}
  {{if eq .Values.favorite.drink "coffee"}}
    mug: true
  {{end}}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rendering_the_extra_space">Rendering the Extra Space</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">data:
  myvalue: "Hello World"
  drink: "coffee"
  food: "PIZZA"
    mug: true</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_attempt_to_fix_space_error">Attempt to Fix Space Error</h3>
<div class="paragraph">
<p>As an attempt we could flush the <code>mug:true</code> up to the <code>if</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"
  drink: {{ .Values.favorite.drink | default "tea" | quote }}
  food: {{ .Values.favorite.food | upper | quote }}
  {{if eq .Values.favorite.drink "coffee"}}
  mug: true
  {{end}}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_what_that_renders">What that renders</h3>
<div class="paragraph">
<p>We get an extra carriage return, where the <code>{{if}}</code> would be</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">data:
  myvalue: "Hello World"
  drink: "coffee"
  food: "PIZZA"

  mug: true</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_special_curly_braced_syntax">Using special curly-braced syntax</h3>
<div class="ulist">
<ul>
<li>
<p><code>{{-</code> (with the dash and space added) indicates that whitespace should be chomped left</p>
</li>
<li>
<p><code>-}}</code> means whitespace to the right should be consumed.</p>
</li>
<li>
<p>Be careful! Newlines are whitespace!</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"
  drink: {{ .Values.favorite.drink | default "tea" | quote }}
  food: {{ .Values.favorite.food | upper | quote }}
  {{- if eq .Values.favorite.drink "coffee"}}
  mug: true
  {{- end}}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reminder_indent_function">Reminder: <code>indent</code> function</h3>
<div class="paragraph">
<p>You can apply the same technique with the <code>indent</code> function</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{indent 2 "mug:true"}}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifying_with_with">Modifying with <code>with</code></h3>
<div class="ulist">
<ul>
<li>
<p><code>with</code> is like a mixin in languages like Ruby</p>
</li>
<li>
<p>Provides a way to set a scope from a value, like <code>.Values.favorites</code></p>
</li>
<li>
<p>May seem similar to <code>import static</code> in Java</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{ with PIPELINE }}
  # restricted scope
{{ end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_with">Using <code>with</code></h3>
<div class="paragraph">
<p>Using <code>with</code>, we can reference <code>.drink</code>, <code>.food</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"
  {{- with .Values.favorite }}
  drink: {{ .drink | default "tea" | quote }}
  food: {{ .food | upper | quote }}
  {{- end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exiting_the_with_appropriately">Exiting the <code>with</code> Appropriately</h3>
<div class="ulist">
<ul>
<li>
<p><code>Release.Name</code> is not in <code>.Values.favorite</code></p>
</li>
<li>
<p>This will return an error</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{- with .Values.favorite }}
drink: {{ .drink | default "tea" | quote }}
food: {{ .food | upper | quote }}
release: {{ .Release.Name }}
{{- end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_correcting_the_with_error">Correcting the <code>with</code> error</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{- with .Values.favorite }}
drink: {{ .drink | default "tea" | quote }}
food: {{ .food | upper | quote }}
{{- end }}
release: {{ .Release.Name }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_looping_with_range">Looping with <code>Range</code></h3>
<div class="paragraph">
<p>Given the following, we would like to "iterate" all the pizza toppings</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">favorite:
  drink: coffee
  food: pizza
pizzaToppings:
  - mushrooms
  - cheese
  - peppers
  - onions</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_range">Using <code>Range</code></h3>
<div class="ulist">
<ul>
<li>
<p><code>range</code> will iterate over the <code>pizzaToppings</code></p>
</li>
<li>
<p><code>.</code> will represent each value</p>
</li>
<li>
<p><code>{{ . | title | quote }}</code> will send each value into <code>title</code> case and then <code>quote</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">toppings: |-
    {{- range .Values.pizzaToppings }}
    - {{ . | title | quote }}
    {{- end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_result_of_using_range">Result of using <code>Range</code></h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">toppings: |-
  - "Mushrooms"
  - "Cheese"
  - "Peppers"
  - "Onions"</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Notice <code>|-</code> is a YAML Multiline String
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_variables">Variables</h3>
<div class="ulist">
<ul>
<li>
<p>Temporary Variables are available</p>
</li>
<li>
<p>Using a previous example that failed because <code>.Release.Name</code> is not in <code>.Values.favorite</code></p>
</li>
<li>
<p>A workaround is to introduce a variable</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{- with .Values.favorite }}
drink: {{ .drink | default "tea" | quote }}
food: {{ .food | upper | quote }}
release: {{ .Release.Name }}
{{- end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_variables">Using <code>Variables</code></h3>
<div class="ulist">
<ul>
<li>
<p>Uses the form <code>$name</code></p>
</li>
<li>
<p>Assigned using a special operator: <code>:=</code></p>
</li>
<li>
<p>Notice the variable is bound <em>before</em> the <code>with</code> block</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"
  {{- $relname := .Release.Name -}}
  {{- with .Values.favorite }}
  drink: {{ .drink | default "tea" | quote }}
  food: {{ .food | upper | quote }}
  release: {{ $relname }}
  {{- end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_after_running_the_example">After Running the Example</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># Source: mychart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: viable-badger-configmap
data:
  myvalue: "Hello World"
  drink: "coffee"
  food: "PIZZA"
  release: viable-badger</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_variables_with_range">Using Variables with <code>range</code></h3>
<div class="ulist">
<ul>
<li>
<p>Variables can be used as an index and value variable for lists</p>
</li>
<li>
<p>Below, <code>index</code> and <code>topping</code> are used to display element number, <code>:</code>, and the element</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">toppings: |-
    {{- range $index, $topping := .Values.pizzaToppings }}
      {{ $index }}: {{ $topping }}
    {{- end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_range_for_key_value_pairs">Using <code>range</code> for Key Value Pairs</h3>
<div class="ulist">
<ul>
<li>
<p>Since <code>./Values.favorite</code> are a list of key value pairs, we can iterate</p>
</li>
<li>
<p>$key will be <code>drink</code>, $val will be <code>coffee</code>, etc.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"
  {{- range $key, $val := .Values.favorite }}
  {{ $key }}: {{ $val | quote }}
  {{- end}}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_result_of_using_range_for_key_value_pairs">Result of using <code>range</code> for Key Value Pairs</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># Source: mychart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: eager-rabbit-configmap
data:
  myvalue: "Hello World"
  drink: "coffee"
  food: "pizza"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_global_variables">Global Variables</h3>
<div class="ulist">
<ul>
<li>
<p><code>$</code> represents the global variable</p>
</li>
<li>
<p>This is useful in a <code>range</code> loop you need a value by navigating from the top</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{- range .Values.tlsSecrets }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .name }}
  labels:
    # Many helm templates would use &lt;code&gt;.&lt;/code&gt; below, but that will not work,
    # however &lt;code&gt;$&lt;/code&gt; will work here
    app.kubernetes.io/name: {{ template "fullname" $ }}
    # I cannot reference .Chart.Name, but I can do $.Chart.Name
    helm.sh/chart: "{{ $.Chart.Name }}-{{ $.Chart.Version }}"
    app.kubernetes.io/instance: "{{ $.Release.Name }}"
    # Value from appVersion in Chart.yaml
    app.kubernetes.io/version: "{{ $.Chart.AppVersion }}"
    app.kubernetes.io/managed-by: "{{ $.Release.Service }}"
type: kubernetes.io/tls
data:
  tls.crt: {{ .certificate }}
  tls.key: {{ .key }}
---
{{- end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_named_templates">Named Templates</h3>
<div class="ulist">
<ul>
<li>
<p>A named template (sometimes called a partial or a subtemplate)</p>
</li>
<li>
<p>A template defined inside of a file, and given a name</p>
</li>
<li>
<p>Declare and manage <code>define</code>, <code>template</code>, <code>include</code> and <code>block</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_partials_and_files">Partials and <code>_</code> Files</h3>
<div class="ulist">
<ul>
<li>
<p>We can create named embedded templates, that can be accessed by name elsewhere</p>
</li>
<li>
<p>Some Conventions:</p>
<div class="ulist">
<ul>
<li>
<p>Most files in <em>templates/</em> are treated as if they contain Kubernetes manifests</p>
</li>
<li>
<p>The <em>NOTES.txt</em> is one exception</p>
</li>
<li>
<p>Files whose name begins with an underscore (<code>_</code>) are assumed to not have a manifest inside.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_declaring_a_template">Declaring a Template</h3>
<div class="paragraph">
<p>The define action allows us to create a named template inside of a template file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{ define "MY.NAME" }}
  # body of template here
{{ end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_example_of_a_template">Example of a Template</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{- define "mychart.labels" }}
  labels:
    generator: helm
    date: {{ now | htmlDate }}
{{- end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_embedding_a_template">Embedding a Template</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{- define "mychart.labels" }}
  labels:
    generator: helm
    date: {{ now | htmlDate }}
{{- end }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
  {{- template "mychart.labels" }}
data:
  myvalue: "Hello World"
  {{- range $key, $val := .Values.favorite }}
  {{ $key }}: {{ $val | quote }}
  {{- end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_template_names_are_global">Template names are global</h3>
<div class="ulist">
<ul>
<li>
<p>Template names are global.</p>
</li>
<li>
<p>If you declare two templates with the same name, whichever one is loaded last will be the one used.</p>
</li>
<li>
<p>Convention is to prefix each defined template with name of the chart</p>
</li>
<li>
<p>Using the specific chart name as a prefix we can avoid any conflicts that may arise due to two different charts that implement templates of the same name.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{ define "mychart.labels" }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_setting_scope_of_a_template">Setting scope of a template</h3>
<div class="paragraph">
<p>The following will add <code>Chart</code> <code>Name</code> and <code>Version</code> albeit incorrectly</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{/* Generate basic labels */}}
{{- define "mychart.labels" }}
  labels:
    generator: helm
    date: {{ now | htmlDate }}
    chart: {{ .Chart.Name }}
    version: {{ .Chart.Version }}
{{- end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_what_it_renders">What it Renders</h3>
<div class="ulist">
<ul>
<li>
<p>Notice that <code>chart</code> and <code>version</code> are missing</p>
</li>
<li>
<p>They were not in the scope</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: moldy-jaguar-configmap
  labels:
    generator: helm
    date: 2016-11-02
    chart:
    version:</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_passing_in_the_scope">Passing in the Scope</h3>
<div class="paragraph">
<p>Instead of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{ define "mychart.labels" }}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We will include <code>.</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{ define "mychart.labels" . }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_resulting_in_the_following">Resulting in the following</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
  {{- template "mychart.labels" .}}
data:
  myvalue: "Hello World"
  {{- range $key, $val := .Values.favorite }}
  {{ $key }}: {{ $val | quote }}
  {{- end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_include_function"><code>include</code> function</h3>
<div class="paragraph">
<p>If provided the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{- define "mychart.app" -}}
app_name: {{ .Chart.Name }}
app_version: "{{ .Chart.Version }}+{{ .Release.Time.Seconds }}"
{{- end -}}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_calling_template">Calling <code>template</code></h3>
<div class="ulist">
<ul>
<li>
<p>Substituting it into template using <code>template</code></p>
</li>
<li>
<p>Notice the location of the <code>template</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
  labels:
    {{ template "mychart.app" .}}
data:
  myvalue: "Hello World"
  {{- range $key, $val := .Values.favorite }}
  {{ $key }}: {{ $val | quote }}
  {{- end }}
{{ template "mychart.app" . }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_incorrect_output">The Incorrect Output</h3>
<div class="ulist">
<ul>
<li>
<p>Notice the location of <code>app_name</code> and <code>app_version</code> in both <code>labels</code> and <code>data</code></p>
</li>
<li>
<p><code>template</code> will organize in it&#8217;s own text alignment</p>
</li>
<li>
<p><code>template</code> is an <em>action</em>, not a function</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># Source: mychart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: measly-whippet-configmap
  labels:
    app_name: mychart
app_version: "0.1.0+1478129847"
data:
  myvalue: "Hello World"
  drink: "coffee"
  food: "pizza"
app_name: mychart
app_version: "0.1.0+1478129847"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_include_is_a_function"><code>include</code> is a Function</h3>
<div class="ulist">
<ul>
<li>
<p><code>include</code> is a function, instead of an action</p>
</li>
<li>
<p>Since it is a function, it is available to be chained to other functions</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
  labels:
    {{- include "mychart.app" . | nindent 4 }}
data:
  myvalue: "Hello World"
  {{- range $key, $val := .Values.favorite }}
  {{ $key }}: {{ $val | quote }}
  {{- end }}
  {{- include "mychart.app" . | nindent 2 }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_what_it_renders_2">What it renders</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># Source: mychart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: edgy-mole-configmap
  labels:
    app_name: mychart
    app_version: "0.1.0+1478129987"
data:
  myvalue: "Hello World"
  drink: "coffee"
  food: "pizza"
  app_name: mychart
  app_version: "0.1.0+1478129987"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Prefer <code>include</code> over <code>template</code>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_accessing_files">Accessing Files</h3>
<div class="ulist">
<ul>
<li>
<p>You can also bring in files into Helm</p>
</li>
<li>
<p>Files must be less than 1M</p>
</li>
<li>
<p>Files in <em>template/</em> directory cannot be accessed</p>
</li>
<li>
<p>Files excluded in <em>.helmignore</em> cannot be accessed</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_creating_standard_files">Creating Standard Files</h3>
<div class="listingblock">
<div class="title">config1.txt</div>
<div class="content">
<pre class="pygments highlight"><code>message = "Hello from config 1"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">config2.txt:</div>
<div class="content">
<pre class="pygments highlight"><code>message = "This is config 2"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">config3.txt</div>
<div class="content">
<pre>message = "Goodbye from config 3"</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_range_to_include_the_files">Using <code>range</code> to include the Files</h3>
<div class="paragraph">
<p>Here, we will use a <code>range list</code> to get all the values in range and print them</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  {{- $files := .Files }}
  {{- range list "config1.txt" "config2.txt" "config3.txt" }}
  {{ . }}: |-
    {{ $files.Get . }}
  {{- end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_results_of_files_and_range">Results of <code>Files</code> and <code>range</code></h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># Source: mychart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: quieting-giraf-configmap
data:
  config1.txt: |-
    message = "Hello from config 1"

  config2.txt: |-
    message = "This is config 2"

  config3.txt: |-
    message = "Goodbye from config 3"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_path_helpers">Path Helpers</h3>
<div class="ulist">
<ul>
<li>
<p>Helm imports many of the functions from Go&#8217;s <a href="https://golang.org/pkg/path/"><code>path</code></a></p>
</li>
<li>
<p>They use the same names, but instead of capital letters it uses small letters</p>
</li>
<li>
<p><code>Base</code> &#8594; <code>base</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Imported Functions</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Base</p>
</li>
<li>
<p>Dir</p>
</li>
<li>
<p>Ext</p>
</li>
<li>
<p>IsAbs</p>
</li>
<li>
<p>Clean</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_glob_patterns">Glob Patterns</h3>
<div class="ulist">
<ul>
<li>
<p><code>Glob</code></p>
<div class="ulist">
<ul>
<li>
<p>Allows you to filter files in glob patterns</p>
</li>
<li>
<p>Returns a <code>Files</code> type, so you may call any of the <code>Files</code> methods on the returned object</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_given_the_files">Given the files</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">foo/:
  foo.txt foo.yaml

bar/:
  bar.go bar.conf baz.yaml</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_glob">Using <code>Glob</code>:</h3>
<div class="ulist">
<ul>
<li>
<p>Notice the <code>$path</code> and <code>$byte</code> are included with <code>Glob</code></p>
</li>
<li>
<p>We can enrich the content of <code>$path</code> and <code>$byte</code> with Go functions</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">{{ $root := . }}
{{ range $path, $bytes := .Files.Glob "foo/*" }}
{{ base $path }}: '{{ $root.Files.Get $path | b64enc }}'
{{ end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configmap_and_secrets_utility">Configmap and Secrets Utility</h3>
<div class="ulist">
<ul>
<li>
<p>Helps with configmaps and secrets</p>
</li>
<li>
<p>Helm Provides some utilities</p>
</li>
<li>
<p>Useful to use these methods in conjunction with the <code>Glob</code> method.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: conf
data:
  {{- (.Files.Glob "foo/*").AsConfig | nindent 2 }}
---
apiVersion: v1
kind: Secret
metadata:
  name: very-secret
type: Opaque
data:
  {{- (.Files.Glob "bar/*").AsSecrets | nindent 2 }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_encoding">Encoding</h3>
<div class="paragraph">
<p>You can apply Base64 encoding using <code>b64enc</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-secret
type: Opaque
data:
  token: |-
    {{ .Files.Get "config1.toml" | b64enc }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lines">Lines</h3>
<div class="paragraph">
<p>To iterate each line in a template, you can use <code>.Files.Lines</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">data:
  some-file.txt: {{ range .Files.Lines "foo/bar.txt" }}
    {{ . }}{{ end }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notes_txt">NOTES.txt</h3>
<div class="ulist">
<ul>
<li>
<p>Provides help to end users</p>
</li>
<li>
<p>Is in plain text</p>
</li>
<li>
<p>Has template functions available</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">Thank you for installing {{ .Chart.Name }}.

Your release is named {{ .Release.Name }}.

To learn more about the release, try:

  $ helm status {{ .Release.Name }}
  $ helm get {{ .Release.Name }}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_5_functions">Lab 5: Functions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Open your lab book, <em>lab_book.html</em>, and do "Lab 5: Functions"</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_subcharts">Subcharts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Agenda:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a chart within a chart</p>
</li>
<li>
<p>Determine data for parents and children</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_subcharts_definition">Subcharts Definition</h3>
<div class="ulist">
<ul>
<li>
<p>Charts can have dependencies called subcharts</p>
</li>
<li>
<p>They have their own values and templates</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_subchart_details">Subchart Details</h3>
<div class="ulist">
<ul>
<li>
<p>Subcharts are considered "stand-alone"</p>
</li>
<li>
<p>Subchart can never</p>
<div class="ulist">
<ul>
<li>
<p>Explicitly depend on its parent chart</p>
</li>
</ul>
</div>
</li>
<li>
<p>Parent Chart can override values of subchart</p>
</li>
<li>
<p>Helm has a concept of global values that can be accessed by all</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_subchart">Creating a subchart</h3>
<div class="ulist">
<ul>
<li>
<p>Change into a directory that is already a chart</p>
</li>
<li>
<p>Create a subchart in that directory using <code>helm create mysubchart</code></p>
</li>
<li>
<p>Clean out templates if you desire to define your own</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% cd mychart/charts
% helm create mysubchart
% rm -rf mysubchart/templates/*.*</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_values_and_template_to_subchart">Adding Values And Template to Subchart</h3>
<div class="paragraph">
<p>In the <code>subchart</code>, there is a <em>Values.yaml</em> file where we can include:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">dessert: cake</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_values_from_subcharts_own_values_yaml">Using <code>Values</code> from Subchart&#8217;s own <code>values.yaml</code></h3>
<div class="paragraph">
<p>We can then create a ConfigMap template in <em>mychart/charts/mysubchart/templates/configmap.yaml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-cfgmap2
data:
  dessert: {{ .Values.dessert }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_what_it_renders_3">What it renders</h3>
<div class="paragraph">
<p>Because the charts works as is, it becomes the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># Source: mysubchart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: newbie-elk-cfgmap2
data:
  dessert: cake</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_overriding_the_defaults">Overriding the defaults</h3>
<div class="ulist">
<ul>
<li>
<p><code>mychart</code> is now the parent of <code>mysubchart</code></p>
</li>
<li>
<p>Since this relationship exists, we can specify configuration at <code>mychart</code> and pushed to <code>mysubchart</code></p>
</li>
<li>
<p>In other words <em>mychart/values.yaml</em></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">favorite:
  drink: coffee
  food: pizza
pizzaToppings:
  - mushrooms
  - cheese
  - peppers
  - onions

mysubchart:
  dessert: ice cream</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The last two lines will have information for the subchart
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_rendering_the_results">Rendering the Results</h3>
<div class="ulist">
<ul>
<li>
<p>Remember that our favorite dessert was <code>cake</code></p>
</li>
<li>
<p>The parent now has an override defined in <code>configmap.yaml</code></p>
</li>
<li>
<p>The following shows the results of the ConfigMap defined in <code>mysubchart</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># Source: mychart/charts/mysubchart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: unhinged-bee-cfgmap2
data:
  dessert: ice cream</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_global_chart_values">Global Chart Values</h3>
<div class="ulist">
<ul>
<li>
<p>Global values are values that can be accessed from any chart or subchart by exactly the same name</p>
</li>
<li>
<p>Globals require explicit declaration</p>
</li>
<li>
<p>You can’t use an existing non-global as if it were a global</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_global_section_in_values">Creating a Global Section in Values</h3>
<div class="ulist">
<ul>
<li>
<p>Both of the following should be able to access the value <code>global.salad</code> as {{ .Values.global.salad}}.</p>
<div class="ulist">
<ul>
<li>
<p><em>mychart/templates/configmap.yaml</em></p>
</li>
<li>
<p><em>mychart/charts/mysubchart/templates/configmap.yaml</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">favorite:
  drink: coffee
  food: pizza
pizzaToppings:
  - mushrooms
  - cheese
  - peppers
  - onions

mysubchart:
  dessert: ice cream

global:
  salad: caesar</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_parent_charts_config_map">Configuring Parent Chart&#8217;s Config Map</h3>
<div class="paragraph">
<p>In <em>mychart/templates/configmap.yaml</em>, notice the <code>salad</code> value</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  salad: {{ .Values.global.salad }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_subcharts_config_map">Configuring Subcharts' Config Map</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-cfgmap2
data:
  dessert: {{ .Values.dessert }}
  salad: {{ .Values.global.salad }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_parent_charts_result">The Parent Chart&#8217;s Result</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"># Source: mychart/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: silly-snake-configmap
data:
  salad: caesar</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_child_charts_result">The Child Chart&#8217;s Result</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: silly-snake-cfgmap2
data:
  dessert: ice cream
  salad: caesar</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sharing_templates_with_subcharts">Sharing Templates with Subcharts</h3>
<div class="ulist">
<ul>
<li>
<p>All templates to include are stored by unique name</p>
</li>
<li>
<p>Therefore they are possible to include in any chart or subchart</p>
</li>
<li>
<p>Be sure to favor <code>include</code> over <code>template</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_6_subcharts">Lab 6: Subcharts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Open your lab book, <em>lab_book.html</em>, and do "Lab 6: Subcharts"</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_plugins">Plugins</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A plugin is a tool that can be accessed through the helm CLI</p>
</li>
<li>
<p>Not part of the built-in Helm</p>
</li>
<li>
<p>Wide array of a <a href="https://v2.helm.sh/docs/related/#helm-plugins">list of plugins</a></p>
</li>
<li>
<p>Also available at <a href="https://github.com/search?q=topic%3Ahelm-plugin&amp;type=Repositories">Github</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_plugin_overview">Plugin Overview</h3>
<div class="ulist">
<ul>
<li>
<p>Integrate with Helm CLI</p>
</li>
<li>
<p>Provide a way to extend the core of Helm</p>
</li>
<li>
<p>Without requiring every new feature to be written in Go</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_plugin_features">Plugin Features</h3>
<div class="ulist">
<ul>
<li>
<p>Can be added and removed from a Helm installation without impacting the core Helm tool</p>
</li>
<li>
<p>Written in any programming language</p>
</li>
<li>
<p>Will show up with <code>helm help</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_installing_a_plugin">Installing a Plugin</h3>
<div class="ulist">
<ul>
<li>
<p>You can pass in a path to a plugin, either</p>
<div class="ulist">
<ul>
<li>
<p>Local file system</p>
</li>
<li>
<p>Url of a remote VCS repo</p>
</li>
</ul>
</div>
</li>
<li>
<p>Plugins get cloned in <code>$(helm home)/plugins</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm plugin install &lt;path|url&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installing_via_tarball">Installing via Tarball</h3>
<div class="ulist">
<ul>
<li>
<p>If you have a plugin tar distribution, simply untar the plugin into the $(helm home)/plugins directory.</p>
</li>
<li>
<p>You can also install tarball plugins directly from url by issuing helm plugin install <a href="http://domain/path/to/plugin.tar.gz" class="bare">http://domain/path/to/plugin.tar.gz</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_example_plugin_s3">Example Plugin: S3</h3>
<div class="ulist">
<ul>
<li>
<p>An Example Plugin is the S3 Plugin[<a href="https://github.com/hypnoglow/helm-s3" class="bare">https://github.com/hypnoglow/helm-s3</a>]</p>
</li>
<li>
<p>It can use AWS S3 as a chart repository</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_creating_the_aws_bucket">Creating the AWS Bucket</h3>
<div class="imageblock">
<div class="content">
<img src="./images/Create-bucket.png" alt="Create bucket">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installing_the_s3_plugin">Installing the S3 Plugin</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm plugin install https://github.com/hypnoglow/helm-s3.git</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_initializing_the_s3_plugin">Initializing the S3 Plugin</h3>
<div class="ulist">
<ul>
<li>
<p>We initialize the plugin using <code>S3 init</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm S3 init s3://my-helm-charts/charts</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>After we can then introduce the URL as a repository</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm repo add my-charts s3://my-helm-charts/charts</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_display_all_the_repos">Display all the repos</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm repo list
NAME            URL
stable          https://kubernetes-charts.storage.googleapis.com
local           http://127.0.0.1:8879/charts
my-charts       s3://my-helm-charts/charts</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_simple_helm_chart">Creating a Simple Helm Chart</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm create test-chart
Creating test-chart
# Remove the initial cruft
$ rm -rf test-chart/templates/*.*
# Create a ConfigMap template at test-chart/templates/configmap.yaml
$ cat > test-chart/templates/configmap.yaml &lt;&lt; EOL
apiVersion: v1
kind: ConfigMap
metadata:
  name: test-chart-configmap
data:
  myvalue: "Hello World"
EOL</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_install_the_chart">Install the Chart</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm install ./test-chart
NAME:   zeroed-armadillo
LAST DEPLOYED: Fri Feb  9 17:10:38 2018
NAMESPACE: default
STATUS: DEPLOYED

RESOURCES:
==&gt; v1/ConfigMap
NAME               DATA  AGE
test-chart-configmap  1     0s</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_remove_it_again">Remove it again</h3>
<div class="ulist">
<ul>
<li>
<p>Since we wanted to ensure that it works</p>
</li>
<li>
<p>We can remove it from the K8S cluster</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"># --purge removes the release from the "store" completely
% helm delete --purge zeroed-armadillo
release "zeroed-armadillo" deleted</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_upload_the_test_chart">Upload the test chart</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm package ./test-chart
Successfully packaged chart and saved it to: ~/test-chart-0.1.0.tgz</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_once_complete_send_it_to_s3">Once complete, send it to S3</h3>
<div class="ulist">
<ul>
<li>
<p>Specify the <code>tgz</code> file</p>
</li>
<li>
<p>Specify the name of the repository</p>
</li>
<li>
<p>Ensure that you version with SemVer2</p>
</li>
<li>
<p>Ensure that you treat each release as immutable</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm s3 push ./test-chart-0.1.0.tgz my-charts</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_helm">Testing Helm</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_unit_testing_helm">Unit Testing Helm</h3>
<div class="paragraph">
<p><a href="https://github.com/quintush/helm-unittest" class="bare">https://github.com/quintush/helm-unittest</a></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Write test file in pure YAML</p>
</li>
<li>
<p>Render locally with no need of tiller</p>
</li>
<li>
<p>Create nothing on your cluster</p>
</li>
<li>
<p>Define values and release options</p>
</li>
<li>
<p>Snapshot testing</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_install_as_plugin">Install as Plugin</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm plugin install https://github.com/quintush/helm-unittest</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>quintush/helm-unittest</code> is the latest plugin that works with Helm Version 3
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_building_a_test">Building a Test</h3>
<div class="ulist">
<ul>
<li>
<p>Create a <code>tests</code> folder</p>
</li>
<li>
<p>Add <code>tests</code> directory to your chart</p>
</li>
<li>
<p>Add file, for example, to <em>$YOUR_CHART/tests/deployment_test.yaml</em></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_example_test">Example Test</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">suite: test deployment
templates:
  - deployment.yaml
tests:
  - it: should work
    set:
      image.tag: latest
    asserts:
      - isKind:
          of: Deployment
      - matchRegex:
          path: metadata.name
          pattern: -my-chart$
      - equal:
          path: spec.template.spec.containers[0].image
          value: nginx:latest</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running_the_test">Running the Test</h3>
<div class="paragraph">
<p>To run the tests</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm unittest $YOUR_CHART</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you wish to use a different folder, you can use <code>-f</code>, or <code>--file</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm unittest -f 'my-tests/*.yaml' -f 'more-tests/*.yaml' my-chart</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_snapshot_testing">Snapshot Testing</h3>
<div class="ulist">
<ul>
<li>
<p>You can take a snapshot of the entire manifest or portions with a snapshot</p>
</li>
<li>
<p>This avoids the need assert every single element</p>
</li>
<li>
<p>This will match an element against the snapshot taken the previous time</p>
</li>
<li>
<p>Snapshots are located in the <code><em>snapshot</em>/*<em>test.yaml.snap</em></code> directory</p>
</li>
<li>
<p>Run <code>-u</code> or <code>--update-snapshot</code> to update the snapshot</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_snapshot_example_test">Snapshot Example Test</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">templates:
  - deployment.yaml
tests:
  - it: pod spec should match snapshot
    asserts:
      - matchSnapshot:
          path: spec.template.spec
  # or you can snapshot the whole manifest
  - it: manifest should match snapshot
    asserts:
      - matchSnapshot: {}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_test_suite_detail">Test Suite Detail</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">suite: test deploy and service
templates:
  - deployment.yaml
  - service.yaml
tests:
  - it: should test something
    ...</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>suite</code>: <em>string, optional</em>. The suite name to show on test result output.</p>
</li>
<li>
<p><code>templates</code>: <em>array of string, recommended</em>. The template files scope to test in this suite, only the ones specified here is rendered during testing. If omitted, all template files are rendered. File suffixed with .tpl is added automatically, you don&#8217;t need to add them again.</p>
</li>
<li>
<p><code>tests</code>: <em>array of test job, required</em>. Where you define your test jobs to run, check Test Job.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_test_job">Test Job</h3>
<div class="paragraph">
<p>The test job is the base unit of testing.
Your chart is rendered each time a test job run, and validated with assertions defined in the test.
You can setup your values used to render the chart in the test job with external values files or directly in the test job definition.</p>
</div>
</div>
<div class="sect2">
<h3 id="_test_details">Test Details</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml">tests:
  - it: should pass
    values:
      - ./values/staging.yaml
    set:
      image.pullPolicy: Always
      resources:
        limits:
          memory: 128Mi
    release:
      name: my-release
      namespace:
      revision: 9
      isUpgrade: true
    asserts:
      - equal:
          path: metadata.name
          value: my-deploy</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>it</code> - Define the name of the test with TDD style or any message you like.</p>
</li>
<li>
<p><code>values</code> - The values files used to renders the chart, like <em>Values.yaml</em></p>
</li>
<li>
<p><code>set</code> - Set the values directly in suite file, analogous to <code>--set</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_various_assertions">Various Assertions</h3>
<div class="ulist">
<ul>
<li>
<p>Equality: <code>equal</code>, <code>notEqual</code></p>
</li>
<li>
<p>Regex: <code>matchRegex</code>, <code>notRegexMatch</code></p>
</li>
<li>
<p>Contains: <code>contains</code>, <code>notContains</code></p>
</li>
<li>
<p>Null: <code>isNull</code>, <code>isNotNull</code></p>
</li>
<li>
<p>Empty: <code>isEmpty</code>, <code>isNotEmpty</code></p>
</li>
<li>
<p>APIVersion: <code>apiVersion</code> of Manifest</p>
</li>
<li>
<p>Number of Documents: <code>hasDocuments</code> Expected number of documents rendered</p>
</li>
<li>
<p>Match Snapshot: Path that should not change from one run to another</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_integration_testing">Integration Testing</h3>
<div class="ulist">
<ul>
<li>
<p>A test in a helm chart lives under the <code>templates/tests</code> directory</p>
</li>
<li>
<p>These are different than a unit test</p>
</li>
<li>
<p>A job or pod definition that specifies a container with a given command to run.</p>
</li>
<li>
<p>Container should run successfully</p>
</li>
<li>
<p>Must have annotation: <code>helm.sh/hook: test</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_example_tests">Example Tests</h3>
<div class="ulist">
<ul>
<li>
<p>Validate that your configuration from the <em>values.yaml</em> file was properly injected.</p>
</li>
<li>
<p>Make sure your username and password work correctly</p>
</li>
<li>
<p>Make sure an incorrect username and password does not work</p>
</li>
<li>
<p>Assert that your services are up and correctly load balancing</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_maria_db_example_helm_test">Maria DB Example Helm Test</h3>
<div class="paragraph">
<p><a href="https://helm.sh/docs/topics/chart_tests/" class="bare">https://helm.sh/docs/topics/chart_tests/</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_run_an_integration_test_on_the_command_line">Run an Integration Test on the Command Line</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh">% helm test [RELEASE] [flags]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_7_testing">Lab 7: Testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Open your lab book, <em>lab_book.html</em>, and do "Lab 7: Testing"</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_commands">Commands</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Commands in Helm</p>
</li>
<li>
<p>For a Complete List visit <a href="https://v2.helm.sh/docs/helm/">the website for details</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_helm_completion"><code>helm completion</code></h3>
<div class="paragraph">
<p>Generate autocompletions script for the specified shell (bash or zsh)</p>
</div>
</div>
<div class="sect2">
<h3 id="_helm_inspect"><code>helm inspect</code></h3>
<div class="ulist">
<ul>
<li>
<p>This command inspects a chart and displays information.</p>
</li>
<li>
<p>It takes a chart reference (‘stable/drupal’), a full path to a directory or packaged chart, or a URL.</p>
</li>
<li>
<p>Inspect prints the contents of the <em>Chart.yaml</em> file and the <em>values.yaml</em> file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>helm inspect chart</code> - shows inspect chart</p>
</li>
<li>
<p><code>helm inspect readme</code> - shows inspect readme</p>
</li>
<li>
<p><code>helm inspect values</code> - shows inspect values</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_helm_list"><code>helm list</code></h3>
<div class="ulist">
<ul>
<li>
<p>This command lists all of the releases.</p>
</li>
<li>
<p>By default, it lists only releases that are deployed or failed. Flags like <code>–deleted</code> and <code>–all</code> will alter this behavior. Such flags can be combined: <code>–deleted –failed</code>.</p>
</li>
<li>
<p>By default, items are sorted alphabetically. Use the <code>-d</code> flag to sort by release date.</p>
</li>
<li>
<p>If an argument is provided, it will be treated as a filter. Filters are regular expressions (Perl compatible) that are applied to the list of releases. Only items that match the filter will be returned.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_helm_package"><code>helm package</code></h3>
<div class="ulist">
<ul>
<li>
<p>Package a chart directory into a chart archive</p>
</li>
<li>
<p>This command packages a chart into a versioned chart archive file.</p>
</li>
<li>
<p>If a path is given, this will look at that path for a chart (which must contain a Chart.yaml file) and then package that directory.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_helm_plugin"><code>helm plugin</code></h3>
<div class="ulist">
<ul>
<li>
<p>Manage helm plugins, including:</p>
<div class="ulist">
<ul>
<li>
<p><code>helm plugin install</code> - Install one or more Helm plugins</p>
</li>
<li>
<p><code>helm plugin list</code> - List installed Helm plugins</p>
</li>
<li>
<p><code>helm plugin remove</code> - Remove one or more Helm plugins</p>
</li>
<li>
<p><code>helm plugin update</code> - Update one or more Helm plugins</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_helm_repo"><code>helm repo</code></h3>
<div class="ulist">
<ul>
<li>
<p>Manage repositories to pull charts and plugins</p>
<div class="ulist">
<ul>
<li>
<p><code>helm repo add</code> - Add a chart repository</p>
</li>
<li>
<p><code>helm repo index</code> - Generate an index file given a directory containing packaged charts</p>
</li>
<li>
<p><code>helm repo list</code> - List chart repositories</p>
</li>
<li>
<p><code>helm repo remove</code> - Remove a chart repository</p>
</li>
<li>
<p><code>helm repo update</code> - Update information of available charts locally from chart repositories</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_helm_upgrade"><code>helm upgrade</code></h3>
<div class="ulist">
<ul>
<li>
<p>Upgrades a release to a specified version of a chart and/or updates chart values.</p>
</li>
<li>
<p>You can use <code>--set</code> for ad-hoc changes</p>
</li>
<li>
<p>Include the release name: <code>helm upgrade [RELEASE] [CHART] [flags]</code></p>
</li>
<li>
<p>All upgrades are available to rollback</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_helm_rollback"><code>helm rollback</code></h3>
<div class="ulist">
<ul>
<li>
<p>Rolls back a release to a previous revision.</p>
</li>
<li>
<p>The first argument of the rollback command is the name of a release</p>
</li>
<li>
<p>Second is a revision (version) number.</p>
</li>
<li>
<p>To see revision numbers, run ‘helm history RELEASE’</p>
</li>
<li>
<p>If you’d like to rollback to the previous release use ‘helm rollback [RELEASE] 0’.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_helm_version"><code>helm version</code></h3>
<div class="ulist">
<ul>
<li>
<p>Display the version</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_8_deploy">Lab 8: Deploy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Open your lab book, <em>lab_book.html</em>, and do "Lab 8: Deploying"</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_is_new_in_helm_v3">What is new in Helm V3?</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_client_only_architecture">Client-Only Architecture</h3>
<div class="ulist">
<ul>
<li>
<p>Helm 3 doesn&#8217;t require Tiller on K8s, unlike Helm 2</p>
</li>
<li>
<p>The main benefit of removing Tiller is that security is now on a per-user basis</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/helm3-arch.png" alt="helm3 arch" width="50%" height="50%">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_xdg_base_directory_specification">XDG base directory specification</h3>
<div class="ulist">
<ul>
<li>
<p>Helm 3 doesn&#8217;t use <code>.helm</code> directory</p>
</li>
<li>
<p>Uses XDG Standard, Platform Independent, Directories</p>
</li>
<li>
<p>XDG Standards: <a href="https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html" class="bare">https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_no_need_to_helm_init">No need to <code>helm init</code></h3>
<div class="ulist">
<ul>
<li>
<p><code>helm init</code> is removed, no need to install</p>
</li>
<li>
<p>Helm state is created when required</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_more_specifics">More specifics</h3>
<div class="paragraph">
<p>Source: <a href="https://developer.ibm.com/technologies/containers/blogs/kubernetes-helm-3/" class="bare">https://developer.ibm.com/technologies/containers/blogs/kubernetes-helm-3/</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_where_to_get_more_information">Where to get more information</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://helm.sh/blog/2019-10-22-helm-2150-released" class="bare">https://helm.sh/blog/2019-10-22-helm-2150-released</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-03-09 20:55:46 -0700
</div>
</div>
</body>
</html>